---
author: Florian Raichle
type: test
bibliography: 'bibliography.bib'
csl: 'ieee.csl'
date: 'November 08, 2021 - May 23, 2022'
title: Simulation of adsorption on moving particles using the Eulerian-Eulerian
    lattice Boltzmann method html
weight: 1
---
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="Florian Raichle" />
  <title>Simulation of adsorption on moving particles using the Eulerian-Eulerian lattice Boltzmann method</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
</head>
<body>
<header id="title-block-header">
<h1 class="title">Simulation of adsorption on moving particles using the Eulerian-Eulerian lattice Boltzmann method html</h1>
<p class="author">Florian Raichle</p>
<p class="date">November 08, 2021 - May 23, 2022</p>
</header>
<h1 id="abstract">Abstract</h1>
<p>To simulate adsorption in industrial applications and gain more insight into the coupling of fluid flow and adsorption performance, adsorption models at larger scales than just single particles are needed. In this thesis a model of the adsorption on moving particles is applied to the lattice Boltzmann method using an Euler-Euler approach. The adsorption model is based on mass transfer as described by the linear driving force model and can incorporate several mass transfer mechanisms, such as film diffusion, surface diffusion and pore diffusion. Particles, their adsorbate loading, and the solute are described by the advection diffusion equation with an adsorption source term.</p>
<p>Using analytical solutions for a batch and fixed bed reactor the model and its coupling with the fluid is validated. Grid studies are conducted to show the convergence of the model. The applicability of the model to complex flow problems is demonstrated in a static mixer with moving particles.</p>
<h1 id="problem-statement">Problem Statement</h1>
<h1 id="sec:declaration" class="unnumbered">Declaration of originality</h1>
<p>I hereby declare that I have composed this work by myself and without any assistance other than the sources given in my list of works cited. This thesis has not been submitted in the past or is currently being submitted to any other examination institution. It has not been published. All direct quotes as well as indirect quotes which in phrasing or original idea have been taken from a different text (written or otherwise) have been marked as such clearly and in each single instance under a precise specification of the source. I am aware that any false claim made here results in failing the examination.</p>
<p><em>Karlsruhe, May 23, 2022</em></p>
<hr />
<p>Florian Raichle</p>
<h1 id="introduction">Introduction</h1>
<p>Many industries and processes use adsorption as a separation technique for multi-component mixtures. The applications can range from small scale chromatography of proteins <span class="citation" data-cites="Dabrowski.2001">(Dąbrowski 2001)</span> to large scale water treatment <span class="citation" data-cites="Berg.2005">(Berg et al. 2005)</span> and petrochemical refinement <span class="citation" data-cites="Azevedo.2001">(Azevedo 2001)</span>. For the analysis and optimization of industrial processes, a large simulation domain with complex geometries and fluid flows are often required. At this scale it is impossible to resolve the interface of the particles and fluid and a volume average in some sense is needed <span class="citation" data-cites="Henn.2016">(Henn et al. 2016)</span>.</p>
<p>The lattice Boltzmann method (<span class="smallcaps">lbm</span>) is gaining interest as an alternative to Navier-Stokes solvers. It has some unique advantages, such as its simple structure and ease of parallelization <span class="citation" data-cites="Kruger.2017 Krause.2021">(Krüger et al. 2017; Krause et al. 2021)</span>. While there have been some uses of <span class="smallcaps">lbm</span> to simulate adsorption on the pore-scale or on discrete particles <span class="citation" data-cites="Long.2016 Agarwal.2005 Manjhi.2006">(Long et al. 2016; Agarwal, Verma, and Mewes 2005; Manjhi et al. 2006)</span>, only few examples of the combination of an Euler-Euler approach to particle and adsorption modelling exist. Peng et al. <span class="citation" data-cites="Peng.2020 Peng.2021">(Peng et al. 2020, 2021)</span> have used <span class="smallcaps">lbm</span> to simulate adsorption on clusters of unresolved particles with a constant particle density. Maier et al. <span class="citation" data-cites="Maier.2018">(Maier et al. 2018)</span> have done work on the adsorption on moving particles but with an Euler-Lagrange approach. Ma et al. <span class="citation" data-cites="Ma.2017">(Ma, Chen, and Liu 2017)</span> have chosen a similar approach to the one taken in this thesis in simulating adsorption using volume averaging but with a multiple relaxation time model. Their work was restricted to simpler kinetics, only applied to a fixed bed reactor and did not provide any data as to the convergence of their method. On the other hand, for other <span class="smallcaps">nse</span> solvers there are examples of Euler-Euler models for reactions in fluidized bed reactors <span class="citation" data-cites="Micale.2021 Vandewalle.2021">(Micale et al. 2021; Vandewalle, Marin, and van Geem 2021)</span>.</p>
<p>This thesis aims to build on these approaches and combine an Euler-Euler description of moving particles with more detailed adsorption kinetics. It first formulates, then employs an adsorption model based on the linear driving force model with transport equations in the form of the advection diffusion equation for particles, solute and particle loading to form advection diffusion reaction equations. These equations are solved using the lattice Boltzmann method with each component of the model being represented by its own lattice. The fluid is one-way coupled with all the other lattices, which themselves are coupled according to the adsorption model.</p>
<p>The first part of this thesis will introduce the underlying concepts and equations for describing adsorption and fluid dynamics. The chosen adsorption model is explained as well. In the second part the combined advection diffusion reaction equations and the numerical model is shown together with explanations on the implementation of the simulations. The last part shows applications and validations of the model in a series of simulations ranging from a simple batch reactor to the complex flow field in a static mixer.</p>
<h1 id="chap:theory">Theory</h1>
<h2 id="adsorption">Adsorption</h2>
<p>Adsorption is a complex process with several interacting mechanisms and length scales involved. In short, it describes a mass transfer process between phases. A substance is removed from a liquid and deposited on a solid or the surface of a liquid. The material that provides the surface is called adsorbent and the substance that is deposited is the adsorbate.</p>
<p>The amount of deposited substance is called particle or adsorbent loading <span class="math inline"><em>q</em></span>. The system generally reaches an equilibrium at a certain adsorbent loading and corresponding solute concentration. An equilibrium of course implies that there are in fact two reactions: adsorption, where the adsorbate is accumulating on the surface and desorption, which is the release of the substance from the surface. Both the properties of the surface and the liquid phase affect the process. Concentration, temperature, pH, surface area and porosity are the key factors here <span class="citation" data-cites="Worch.2021">(Worch 2021)</span>.</p>
<p>Although adsorption is fundamentally a surface process, the adsorbent uptake is usually measured as a mass related loading <span class="math inline"><em>q</em></span> with <br /><span class="math display">$$q = \frac{m_a}{m_A}\,,$$</span><br /> where <span class="math inline"><em>m</em><sub><em>a</em></sub></span> is the mass of the adsorbed substance and <span class="math inline"><em>m</em><sub><em>A</em></sub></span> the mass of the adsorbent. Alternatively <span class="math inline"><em>q</em></span> can also be a quotient based on molar concentration using <span class="math inline"><em>n</em><sub><em>a</em></sub></span>. We will use a mass concentration <span class="math inline"><em>C</em> = <em>m</em><sub><em>S</em></sub>/<em>V</em><sub><em>L</em></sub></span> for the solute concentration as well, where <span class="math inline"><em>m</em><sub><em>S</em></sub></span> stands for the mass of the solute in solution with the solution volume <span class="math inline"><em>V</em><sub><em>L</em></sub></span>.</p>
<p>A rigorous theoretical description of adsorption has only been achieved for simple cases like pure gas adsorption. Since this thesis is concerned with adsorption from aqueous solutions, which are even in the simplest case multi-component systems, these theoretical developments will not be expanded upon. For adsorption from liquid solution the adsorbent uptake can only ever be measured relative to the solvent uptake. This makes general prediction of the relevant parameters much more difficult. This fundamental difference, however, does not matter that much in practice and most of the following observations apply to both types of systems <span class="citation" data-cites="Worch.2021">(Worch 2021)</span>.</p>
<p>Adsorption in industrial practice is, as a separation process, almost always concerned with multiple components. In this thesis we will focus on single solute systems. Multicomponent systems generally differ in two ways: competitive adsorption changes the equilibrium, which can be accounted for by using multicomponent isotherms, and secondly interactions during mass transport, which necessitates the inclusion of the concentration gradients of all components into the kinetic model.</p>
<h3 id="adsorption-isotherms">Adsorption Isotherms</h3>
<p>The adsorption equilibrium is characterized using so-called isotherms, which describe the eventual loading <span class="math inline"><em>q</em><sub><em>e</em><em>q</em></sub></span> of a particle once the equilibrium is reached. This can take several hours to days, depending on the material.</p>
<p>An adsorption isotherm in general is the relationship between the concentration in the fluid phase <span class="math inline"><em>C</em></span> and the loading, or <span class="math inline"><em>q</em><sub><em>e</em><em>q</em></sub> = <em>f</em>(<em>C</em><sub><em>e</em><em>q</em></sub>)</span> with <span class="math inline"><em>T</em> = const</span>. Most commonly this function is determined in batch experiments. There are several models that can be used to describe this relation using differing numbers of parameters <span class="citation" data-cites="Foo.2010">(Foo and Hameed 2010)</span>. Three of the most common ones have been used in this thesis and are shown in fig. <a href="#fig:isotherms" data-reference-type="ref" data-reference="fig:isotherms">[fig:isotherms]</a>.</p>
<p>The simplest form is simply a constant <span class="math inline"><em>q</em> = <em>K</em></span>, which corresponds to an irreversible reaction. This may only be applicable for very high concentrations and is only mentioned here for completeness.</p>
<h4 id="linear-isotherm">Linear Isotherm</h4>
<p>The linear relationship between concentration and loading is also called Henry isotherm and relates the loading to concentration by <br /><span class="math display"><em>q</em> = <em>K</em><em>C</em> ,</span><br /> with <span class="math inline"><em>K</em></span> as the single isotherm parameter often given in <span class="math inline"><em>L</em>/<em>g</em></span>.</p>
<p>It can be sufficient for applications with very small concentrations, as it is the limiting case for <span class="math inline"><em>C</em> → 0</span> <span class="citation" data-cites="Worch.2021">(Worch 2021)</span>. Additionally, it is useful in model validation, because it enables the formulation of analytical solutions for many models. For this reason it is used in the validation section of this thesis.</p>
<h4 id="freundlich-isotherm">Freundlich Isotherm</h4>
<p>The Freundlich isotherm is a purely empirical observation, but describes many processes, including many liquid adsorptions systems, fairly well <span class="citation" data-cites="Worch.2021">(Worch 2021)</span>. In this case the loading is <br /><span class="math display"><em>q</em> = <em>K</em><em>C</em><sup><em>n</em></sup> ,</span><br /> with the isotherm parameters <span class="math inline"><em>K</em></span> and <span class="math inline"><em>n</em></span>. Depending on the exponent <span class="math inline"><em>n</em></span>, the isotherm can either be favorable (<span class="math inline"><em>n</em> &lt; 1</span>) or unfavorable (<span class="math inline"><em>n</em> &gt; 1</span>). The unit of <span class="math inline"><em>K</em></span> depends on the units of <span class="math inline"><em>C</em></span> and crucially also <span class="math inline"><em>n</em></span>. For this reason, conversion between units for <span class="math inline"><em>q</em></span> and <span class="math inline"><em>C</em></span> is tricky but certainly possible.</p>
<h4 id="langmuir-isotherm">Langmuir Isotherm</h4>
<p>A very popular choice is the Langmuir isotherm. It is based on the assumption of a homogenous surface and monolayer adsorption. In the equilibrium we get a loading <br /><span class="math display">$$q = q_m\, \frac{b\,C}{1 + b\,C}$$</span><br /> with the two constants <span class="math inline"><em>q</em><sub><em>m</em></sub></span> and <span class="math inline"><em>b</em></span>. In the case of adsorption from liquid, unlike in gas adsorption, the parameters <span class="math inline"><em>q</em><sub><em>m</em></sub></span> and <span class="math inline"><em>b</em></span> do not hold any physical significance and are simply fitting parameters.</p>
<h3 id="adsorption-kinetics">Adsorption Kinetics</h3>
<p>Because reaching equilibrium can take some time, the kinetics play an important role in many processes. Several steps are involved in the adsorption process, the slowest of which will be rate determining <span class="citation" data-cites="Worch.2021">(Worch 2021)</span>:</p>
<ol>
<li><p>Bulk transport is the usually purely advective transport of the solute to the particle in question. It only depends on the flow field in the reactor and around the particle.</p></li>
<li><p>Every particle will have a boundary layer around it. The diffusive transport through that film is called film diffusion or external mass transport but should not be confused with the bulk transport in step 1. This is step 1 in fig. <a href="#fig:transfer_mechanisms" data-reference-type="ref" data-reference="fig:transfer_mechanisms">[fig:transfer_mechanisms]</a>.</p></li>
<li><p>Intraparticle diffusion is the transport from the surface of the particle to the interior by two different mass transfer mechanisms, pore and surface diffusion. They are steps 2 and 3 in fig. <a href="#fig:transfer_mechanisms" data-reference-type="ref" data-reference="fig:transfer_mechanisms">[fig:transfer_mechanisms]</a> respectively.</p></li>
<li><p>The last step is the actual surface interaction and what we would call the adsorption reaction.</p></li>
</ol>
<p>In most cases it is assumed that step one and four are fast enough to be disregarded and only external mass transfer and intraparticle mass transfer are considered <span class="citation" data-cites="LeVan.2019">(LeVan, Carta, and Walton 2019)</span>.</p>
<span><embed src="pore.png" title="fig:" />
<p><span id="fig:transfer_mechanisms" label="fig:transfer_mechanisms">[fig:transfer_mechanisms]</span></p>
<p>Common model assumptions are: constant temperature, completely mixed bulk solution, mass transfer can be described as diffusion process, surface reaction is much faster than diffusion and the adsorbent particles are spherical and identical.</p>
<p>Based on these rate determining steps, equations for the kinetics can be derived. In the simplest case, only one step needs to be included, but combinations are also possible and may result in more accurate models.</p>
<p>Alternatively some empirical rate equations have been proposed and are frequently used in the literature describing adsorbents. Their predictive power, however, is very limited as they can combine several mechanisms in their constants <span class="citation" data-cites="Islam.2004 Kruger.2017 Wang.2020">(Islam, Khan, and Mozumder 2004; Krüger et al. 2017; Wang and Guo 2020)</span>. Their rate constants are usually only applicable to the specific experimental setups they were determined with.</p>
<p>These adsorption rates can be incorporated as a source term into the advection-diffusion equations, as shown by He <span class="citation" data-cites="He.2000">(He, Li, and Goldstein 2000)</span> and Peng <span class="citation" data-cites="Peng.2021">(Peng et al. 2021)</span>. The experimental determination of adsorption kinetic parameters can be difficult, so it is important that we use as few as possible parameters in our model.</p>
<h4 id="pore-volume-and-surface-diffusion-model">Pore Volume and Surface Diffusion Model</h4>
<p>The most complete model, which incorporates external mass transfer and intraparticle diffusion, is called Pore Volume and Surface Diffusion Model or <span class="smallcaps">pvsdm</span> <span class="citation" data-cites="Dotto.2017">(Dotto et al. 2017)</span>. The different mass transfer mechanisms that comprise this model are listed in the following sections, as they can be the basis for their own models when a single mechanism dominates.</p>
<p>These models are all based on the description of the adsorption behavior of a single particle, some even taking into account the concentration profile inside the particle.</p>
<h4 id="film-diffusion">Film Diffusion</h4>
<p>The first step is the transport of the solved adsorbate to the surface of the adsorbent particle, also called external mass transfer. A lower concentration of adsorbate at the surface <span class="math inline"><em>C</em><sub><em>s</em></sub></span> causes a gradient that is confined to a layer with thickness <span class="math inline"><em>δ</em></span>. Under the assumption of a linear gradient and disregarding all other mass transfer mechanisms, the mass transfer can be determined using Fick’s Law: <br /><span class="math display">$$\dot{m}_f = \frac{D_L}{\delta} \frac{A_s}{m_A} \left(C-C_s\right)\,.$$</span><br /></p>
<p>The quotient <span class="math inline"><em>A</em><sub><em>s</em></sub>/<em>m</em><sub><em>A</em></sub> = <em>a</em><sub><em>m</em></sub></span> is the ratio of surface area to available mass of adsorbent and is a common measure in adsorption. <span class="math inline"><em>D</em><sub><em>L</em></sub></span> is the diffusion coefficient of the liquid phase, <span class="math inline"><em>C</em></span> is the concentration in the liquid phase and <span class="math inline"><em>C</em><sub><em>s</em></sub></span> is the concentration near the particle surface.</p>
<p>The hydrodynamic conditions in the fluid influence the degree to which film diffusion plays a role. For high fluid velocities, caused for example by increased stirring, film diffusion will become less important and the following transfer mechanisms will dominate <span class="citation" data-cites="Worch.2021">(Worch 2021)</span>.</p>
<h4 id="surface-diffusion">Surface Diffusion</h4>
<p>Surface diffusion describes the transport of the adsorbate in the adsorbed state on the internal surfaces or pores of the particle. It takes place in pores that are so small that the adsorbing molecules cannot escape the influence of the pore surface <span class="citation" data-cites="LeVan.2019">(LeVan, Carta, and Walton 2019)</span>. From Fick’s law we get <br /><span class="math display">$$\dot{m}_s = \rho_P D_s \frac{\partial q}{\partial r}\,,$$</span><br /> which can be transformed using a material balance for a spherical particle to <br /><span class="math display">$$\frac{\partial q}{\partial t} = D_s \left(\frac{\partial^2 q}{\partial r^2} + \frac{2}{r} \frac{\partial q}{\partial r}\right)\,.$$</span><br /> Depending on whether film diffusion is considered as well, it can be in series with surface diffusion, which would be reflected in the boundary condition for the concentration at the particle surface.</p>
<h4 id="pore-diffusion">Pore Diffusion</h4>
<p>While surface diffusion takes place on the walls of the pores, pore diffusion refers to mass transport in the pore liquid where the influence of the pore surface can be neglected <span class="citation" data-cites="LeVan.2019">(LeVan, Carta, and Walton 2019)</span>. This makes the calculation more difficult as the equilibrium has to be taken into account at every point in the pore system. A simplified equation <span class="citation" data-cites="Worch.2021">(Worch 2021)</span> was found to be <br /><span class="math display">$$\rho_p \frac{\partial q}{\partial t} = D_p \left(\frac{\partial^2 c_p}{\partial r^2} + \frac{2}{r} \frac{\partial c_p}{\partial r}\right)\,.$$</span><br /></p>
<p>Surface and pore diffusion can be combined into effective diffusion coefficients. For that, either a surface diffusion model or a pore diffusion model is used as the basis and the other mechanism is incorporated as a contribution depending on the isotherm slope. For linear isotherms either approach leads to an identical solution and the two mechanisms can be considered equivalent. <span class="citation" data-cites="Worch.2021">(Worch 2021)</span></p>
<h3 id="linear driving force">Linear Driving Force Model</h3>
<p>Adsorption primarily happens at interfaces and is a heterogeneous reaction and, especially with moving particles, not a bulk phenomenon. This makes it very difficult to describe accurately using an Euler-Euler approach where the particle and interfaces cannot be resolved. We cannot, for example, incorporate a granular representation of the concentration gradients inside every single particle. To work around this issue, Glueckauf and Coates <span class="citation" data-cites="Glueckauf.1947">(Glueckauf and Coates 1947)</span> proposed a linearized approach, called linear driving force model (<span class="smallcaps">ldf</span>), which is now widely used in adsorption modeling, especially in the description of fixed bed reactors <span class="citation" data-cites="Hsuen.2000 Sircar.2000">(Hsuen 2000; Sircar and Hufton 2000)</span>.</p>
<p>It postulates an area inside the particle with a linear concentration gradient similar to film diffusion and a core with a spatially constant concentration <span class="math inline"><em>q̄</em>(<em>t</em>)</span>. This is shown in figure <a href="#fig:internal_mass_transfer" data-reference-type="ref" data-reference="fig:internal_mass_transfer">[fig:internal_mass_transfer]</a>. The model was also derived by Liaw et al. <span class="citation" data-cites="Liaw.1979">(Liaw et al. 1979)</span>, who found that overall this is equivalent to a parabolic concentration profile in the particle. While the model was originally developed to simplify the surface diffusion model it can be extended to include several transfer mechanisms as will be shown below.</p>
<p><span id="fig:internal_mass_transfer" label="fig:internal_mass_transfer">[fig:internal_mass_transfer]</span></p>
<p>The internal mass transport through surface diffusion is <br /><span class="math display"><em>ṁ</em><sub><em>i</em><em>n</em><em>t</em></sub> = <em>ρ</em><sub><em>p</em></sub><em>k</em><sub><em>s</em></sub>(<em>q</em><sub><em>s</em></sub>−<em>q̄</em>) ,</span><br /> with the surface diffusion coefficient <span class="math inline"><em>k</em><sub><em>s</em></sub></span> and the particle density <span class="math inline"><em>ρ</em><sub><em>p</em></sub></span>. The surface loading is determined by the isotherm <span class="math inline"><em>q</em><sub><em>s</em></sub>(<em>t</em>) = <em>f</em>(<em>C</em><sub><em>s</em></sub>(<em>t</em>))</span>. When external mass transfer is not included, <span class="math inline"><em>C</em><sub><em>s</em></sub> = <em>C</em></span>. For spherical particles it was shown <span class="citation" data-cites="Glueckauf.1947">(Glueckauf and Coates 1947)</span> that <br /><span class="math display">$$k_s = \frac{5 D_s}{r_P}\,.$$</span><br /></p>
<p>The mass balance for a single particle and the surrounding fluid reads <br /><span class="math display">$$\label{eq:mass_balance_particle}
    \dot{m}_{\mathrm{int}} = \frac{m_A}{A_s} \frac{d\bar{q}}{dt} = - \frac{V_L}{A_s}\frac{dc}{dt}\,.$$</span><br /> When we substitute eq. <a href="#eq:mass_transfer_surface" data-reference-type="eqref" data-reference="eq:mass_transfer_surface">[eq:mass_transfer_surface]</a> for the mass transport <span class="math inline"><em>ṁ</em><sub><em>i</em><em>n</em><em>t</em></sub></span> in eq. <a href="#eq:mass_balance_particle" data-reference-type="eqref" data-reference="eq:mass_balance_particle">[eq:mass_balance_particle]</a> we find the mass transfer equation <br /><span class="math display">$$\label{eq:LDF_transfer_loading}
    \frac{d \bar{q}}{d t} = k_s \frac{A_s}{V_A} \left(q_s - \bar{q}\right) = k_s^* \left(q_s - \bar{q}\right)\,.$$</span><br /> For convenience we combine the factors in <a href="#eq:LDF_transfer_loading" data-reference-type="eqref" data-reference="eq:LDF_transfer_loading">[eq:LDF_transfer_loading]</a> so that <br /><span class="math display">$$k_s^* = k_s \frac{A_s}{V_A} = \frac{15 D_s}{r_p^2}.$$</span><br /></p>
<p>Together with the mass balance we can also calculate the change in concentration <br /><span class="math display">$$\label{eq:LDF_transfer_concentration}
    -\frac{d c}{d t} = k_s^* \frac{\rho_p (1-\varepsilon_B)}{\varepsilon_B} \left(q_s - \bar{q}\right)$$</span><br /> with the factor <span class="math inline">$\frac{\rho_p (1-\varepsilon_B)}{\varepsilon_B} = \frac{m_A}{V_L}$</span> converting the adsorbate loading, which is defined per mass of adsorbent, to concentration, which is defined per volume of liquid. The particle volume is included using the bed porosity <span class="math inline"><em>ε</em><sub><em>B</em></sub></span>.</p>
<p>If we do not incorporate film diffusion into the model, the surface loading is simply the equilibrium loading corresponding to the bulk concentration: <br /><span class="math display"><em>q</em><sub><em>s</em></sub> = <em>f</em>(<em>C</em>)</span><br /></p>
<p>It has been shown that this model can achieve impressive accuracy while reducing the computational effort <span class="citation" data-cites="HASHIMOTO.1976 Worch.2008">(Hashimoto and Miura 1976; Worch 2008)</span> which makes it especially useful for numerical simulations. A short comparison between the <span class="smallcaps">ldf</span> model and the <span class="smallcaps">hsdm</span> can be found in appendix <a href="#sec:app:LDFHSDM" data-reference-type="ref" data-reference="sec:app:LDFHSDM">8</a>.</p>
<p>To increase the accuracy of the model further, a variable mass transfer coefficient can be introduced <span class="citation" data-cites="Worch.2021">(Worch 2021)</span>. Using <br /><span class="math display"><em>k</em><sub><em>s</em></sub><sup>*</sup> = <em>k</em><sub><em>s</em>0</sub><sup>*</sup>exp <em>ω</em><em>q̄</em></span><br /> with the additional empirical parameters <span class="math inline"><em>ω</em></span> and <span class="math inline"><em>k</em><sub><em>s</em>0</sub><sup>*</sup></span>. These parameters however have to be determined through curve-fitting of experimental data.</p>
<h4 id="film-diffusion-1">Film Diffusion</h4>
<p>The model can be extended to include film diffusion on the outside of the particle as well. This configuration is shown in fig. <a href="#fig:external_mass_transfer" data-reference-type="ref" data-reference="fig:external_mass_transfer">[fig:external_mass_transfer]</a>. The mass flow due to film transfer is <br /><span class="math display">$$\dot{m}_{\mathrm{film}} = k_{f} \frac{A_s}{m_A} \left(C-C_s\right)\,.$$</span><br /></p>
<p><span id="fig:external_mass_transfer" label="fig:external_mass_transfer">[fig:external_mass_transfer]</span></p>
<p>It acts as a boundary condition which we solve to get the surface concentration <span class="math inline"><em>C</em><sub><em>s</em></sub></span>. With the condition that <span class="math inline"><em>ṁ</em><sub><em>i</em><em>n</em><em>t</em></sub> = <em>ṁ</em><sub><em>f</em><em>i</em><em>l</em><em>m</em></sub></span> as a basis we get <br /><span class="math display"><em>ρ</em><sub><em>p</em></sub><em>k</em><sub><em>s</em></sub>(<em>q</em><sub><em>s</em></sub> − <em>q̄</em>) = <em>k</em><sub><em>f</em></sub>(<em>C</em> − <em>C</em><sub><em>s</em></sub>) </span><br /> where the surface loading <span class="math inline"><em>q</em><sub><em>s</em></sub></span> is a function of <span class="math inline"><em>C</em><sub><em>s</em></sub></span> via the equilibrium. Once the new surface concentration has been found, the corresponding surface loading can be calculated and used as before in eq. <a href="#eq:LDF_transfer_loading" data-reference-type="eqref" data-reference="eq:LDF_transfer_loading">[eq:LDF_transfer_loading]</a>.</p>
<h4 id="pore-diffusion-1">Pore Diffusion</h4>
<p>The <span class="smallcaps">ldf</span> model can also be applied to pore diffusion with some simplifications. By replacing the quotient <span class="math inline">∂<em>q</em>/∂<em>C</em></span> that occurs in the model with <span class="math inline"><em>q</em><sub>0, <em>e</em><em>q</em></sub>/<em>C</em><sub>0</sub></span>, as shown by <span class="citation" data-cites="Worch.2021 Neretnieks.1976">(Worch 2021; Neretnieks 1976)</span>, an effective mass transfer coefficient can be formulated to include the pore diffusion coefficient. <br /><span class="math display">$$k_{s, \mathrm{eff}}^* = \frac{15 D_s}{r_p^2} + \frac{15 D_p}{r_p^2} \frac{C_0}{\rho_p\, q_{0,eq}}$$</span><br /> Here <span class="math inline"><em>C</em><sub>0</sub></span> denotes the inlet solute concentration and <span class="math inline"><em>q</em><sub>0, <em>e</em><em>q</em></sub></span> the corresponding equilibrium loading. This new coefficient can be substituted in eq. <a href="#eq:LDF_transfer_loading" data-reference-type="eqref" data-reference="eq:LDF_transfer_loading">[eq:LDF_transfer_loading]</a> and <a href="#eq:LDF_transfer_concentration" data-reference-type="eqref" data-reference="eq:LDF_transfer_concentration">[eq:LDF_transfer_concentration]</a> in cases where pore and surface diffusion both contribute significantly.</p>
<h4 id="sec:cyclical_adsorption">Cyclical Adsorption</h4>
<p>The <span class="smallcaps">ldf</span> model uses a very simple equation for the mass transfer coefficient <span class="math inline"><em>k</em><sub><em>s</em></sub></span>. It has been shown that this assumption is not always valid for cyclical processes with short cycle times <span class="citation" data-cites="Ruthven.1984 Choong.1998">(Ruthven 1984; Choong and Scott 1998)</span>. The cause for this are the assumptions made about the linear concentration profile inside the particle. This will lead to desorption being underestimated <span class="citation" data-cites="Nakao.1983">(Nakao and Suzuki 1983)</span>.</p>
<p>Dominating film diffusion, on the other hand, will reduce the influence of cyclicality because it is independent of the concentration profile inside the particle.</p>
<h3 id="reaction-kinetics">Reaction Kinetics</h3>
<p>Experimental data is very often fitted with empirical reaction kinetic models <span class="citation" data-cites="Worch.2021 Qiu.2009">(Worch 2021; Qiu et al. 2009)</span>. While they can produce well fitting results, these models do not directly allow any mechanistic insight. They rely only on fitting parameters, which are often only valid for a specific experimental setup <span class="citation" data-cites="Worch.2021">(Worch 2021)</span>. The most common ones are called pseudo-first-order and pseudo-second-order kinetics <span class="citation" data-cites="Ho.1998b Ho.1998">(Ho and McKay 1998a, 1998b)</span>. They are based on the difference between the equilibrium loading and the current loading of the particle. The first order equation is <br /><span class="math display">$$\frac{d \bar{q}}{d t} = k_1 \left(q_{\mathrm{eq}} - \bar{q} \right)$$</span><br /> and the second order <br /><span class="math display">$$\frac{d \bar{q}}{d t} = k_2 \left(q_{\mathrm{eq}} -\bar{q} \right)^2\,.$$</span><br /> The equations are similar to the linear driving force model, the difference however is in the driving force. The equilibrium loading <span class="math inline"><em>q</em><sub><em>e</em><em>q</em></sub></span> is the final particle loading of the experiment and therefore a constant. The surface loading used in the linear driving force model is dependent on time.</p>
<h3 id="parameter-estimation">Parameter Estimation</h3>
<p>In most cases adsorption parameters cannot be predicted. Experiments have to be conducted, and the parameters can then be determined by using an appropriate model and fitting techniques.</p>
<p>Isotherm parameters are usually determined in batch experiments by measuring the concentration at different points in time and then the adsorbed amount is calculated with a mass balance. The isotherm parameters are determined by fitting an appropriate isotherm model. Attempts at predicting isotherms using, amongst others, potential theory have been made, but their predictive power is often limited. <span class="citation" data-cites="Worch.2021">(Worch 2021)</span></p>
<p>If we want to model adsorption kinetics in a wide spectrum of conditions, we need to separate the influence of different mass transfer mechanism and determine their respective mass transfer coefficients. The film mass transfer coefficient can for example be determined in a short fixed bed reactor, as the film diffusion will be dominant at first. Several empirical correlations also exist, most using the Sherwood number as a function of the Reynolds number <span class="math inline"><em>R</em><em>e</em></span> and the Schmidt number <span class="math inline"><em>S</em><em>c</em></span>.</p>
<p>Intraparticle diffusion coefficients for surface and pore diffusion can be determined in batch experiments by applying the linear driving force model and calculating an average value of <span class="math inline"><em>k</em><sub><em>s</em></sub><sup>*</sup></span> from the change in concentration <span class="math inline"><em>d</em><em>C</em>/<em>d</em><em>t</em></span>. Worch <span class="citation" data-cites="Worch.2008">(Worch 2008)</span> also gives an empirical correlation for the adsorption of micropollutants onto activated carbon. For other systems, different correlations would be needed.</p>
<h3 id="sec:batch_reactor">Batch Reactor Model</h3>
<p>The simplest reactor for adsorption is a batch reactor. The differential mass balance reads <br /><span class="math display">$$m_A \frac{d \bar{q}}{d t} = - V_L \frac{d C}{d t}\,.$$</span><br /> Integration with the initial conditions <span class="math inline"><em>C</em>(0) = <em>C</em><sub>0</sub></span> and <span class="math inline"><em>q̄</em>(0) = 0</span> leads to <br /><span class="math display">$$\bar{q}(t) = \frac{V_L}{m_A} \left(C_0 - C(t)\right)$$</span><br /> We can visualize this as an operating line as seen in fig. <a href="#fig:operating lines" data-reference-type="ref" data-reference="fig:operating lines">[fig:operating lines]</a> with the term <span class="math inline"> − <em>V</em><sub><em>L</em></sub>/<em>m</em><sub><em>A</em></sub></span> as the slope.</p>
<p>Together with the mass transfer equations for <span class="math inline"><em>d</em><em>C</em>/<em>d</em><em>t</em></span> and <span class="math inline"><em>d</em><em>q̄</em>/<em>d</em><em>t</em></span>, that were derived by looking at a single particle, the equilibrium relationship <span class="math inline"><em>q</em> = <em>f</em>(<em>C</em>)</span> and initial conditions this system of equations is complete. It can usually only be solved numerically, except for the case of a linear equilibrium, where an analytical solution exists. The application of the single particle kinetics to the batch reactor assumes homogenous particles and conditions in the volume element.</p>
<p>In summary, when using the <span class="smallcaps">ldf</span> model, the system of equations is as follows <br /><span class="math display">$$\begin{gathered}
    \frac{d \bar{q}}{d t} = k_s^* \left(q_s - \bar{q}\right)\\
    -\frac{d c}{d t} = k_s^* \frac{(1-\varepsilon_B)}{\varepsilon_B} \rho_p  \left(q_s - \bar{q}\right)\\
    \rho_p k_s(q_s - \bar{q}) = k_f (C - C_s)\\\label{eq:film_balance}
    q_s = f(C_s)\\
    \bar{q}(t=0) = 0, \quad C(t=0) = C_0
\end{gathered}$$</span><br /> The third equation only applies when film diffusion is included. This system of equations is also the basis for the discretized model where each node at each time step can be thought of as a small batch reactor.</p>
<h3 id="fixed-bed-reactor-model">Fixed Bed Reactor Model</h3>
<p>In a fixed bed reactor the adsorbent is usually in granular form and is packed in a porous bed. During operation, solute of a certain concentration is introduced at the inlet and a steady flow is maintained. The solute travels from the inlet through the column and accumulates on the adsorbent particles until equilibrium is reached. A distinct concentration front forms as initially all the adsorbate can be removed from the solution, leading to a much lower concentration in most of the bed than at the inlet. Only after enough adsorbate has accumulated on the particles and the reaction slows down, does the concentration increase downstream. The velocity of this concentration front is much slower than that of the fluid and depends (in the ideal case) only on the inlet concentration and the amount of adsorbent in the bed.</p>
<p>For adsorption where kinetics play a role, the equilibrium is not reached instantaneously and a characteristic mass transfer zone (<span class="smallcaps">mtz</span>) can be observed. Its shape depends both on the kinetics and the equilibrium <span class="citation" data-cites="Glueckauf.1947">(Glueckauf and Coates 1947)</span>. An example can be seen in figure <a href="#fig:fixed_bed_profile" data-reference-type="ref" data-reference="fig:fixed_bed_profile">[fig:fixed_bed_profile]</a>. The progress of the center of mass of the <span class="smallcaps">mtz</span>, however, will still only depend on the equilibrium.</p>
<p><span id="fig:fixed_bed_profile" label="fig:fixed_bed_profile">[fig:fixed_bed_profile]</span></p>
<p>There are three stages that every particle experiences, which can be seen as more or less distinct zones. These are shown in fig <a href="#fig:fixed_bed_profile" data-reference-type="ref" data-reference="fig:fixed_bed_profile">[fig:fixed_bed_profile]</a> as well. Zone I is simply an unloaded bed with <span class="math inline"><em>C</em> = 0</span> and usually an initial loading <span class="math inline"><em>q</em>(<em>t</em> = 0) = 0</span>. The second zone is the <span class="smallcaps">mtz</span> where the mass transfer takes place and the concentration rises. In the third zone, which is closest to the inlet, the particles are already saturated and no net mass transfer takes place. Therefore, the solution still has its initial concentration. The time it takes for the center of mass of the <span class="smallcaps">mtz</span> to reach the outlet is called ideal breakthrough time <span class="math inline"><em>t</em><sub><em>b</em></sub><sup><em>i</em><em>d</em></sup></span>. The balance equation in the ideal case of instantaneous equilibrium is <br /><span class="math display"><em>C</em><sub>0</sub><em>V̇</em><em>t</em><sub><em>b</em></sub><sup><em>i</em><em>d</em></sup> = <em>q</em><sub>0</sub><em>m</em><sub><em>A</em></sub> + <em>C</em><sub>0</sub><em>ε</em><sub><em>B</em></sub> <em>V</em><sub><em>R</em></sub> ,</span><br /> with <span class="math inline"><em>V</em><sub><em>R</em></sub></span> as the reactor volume. This gives us the ideal breakthrough time as <br /><span class="math display">$$t_b^{id} = \frac{q_0\, m_A}{C_0 \dot{V}} + \frac{\varepsilon_B\, V_R}{\dot{V}} = t_{\mathrm{st}} + t_r\,,$$</span><br /> which can be split into the stoichiometric time <span class="math inline"><em>t</em><sub><em>s</em><em>t</em></sub></span> and the residence time <span class="math inline"><em>t</em><sub><em>r</em></sub></span>. If <span class="math inline"><em>t</em><sub><em>s</em><em>t</em></sub> ≫ <em>t</em><sub><em>r</em></sub></span>, the residence time can be neglected <span class="citation" data-cites="Worch.2021">(Worch 2021)</span>. By substituting the column height <span class="math inline"><em>h</em></span> using <span class="math inline"><em>V</em><sub><em>R</em></sub> = <em>h</em><em>ρ</em><sub><em>B</em></sub></span> we can derive the velocity of the <span class="smallcaps">mtz</span> with <br /><span class="math display">$$\label{eq:mtz_velocity}
    v_{\textsc{\MakeLowercase{MTZ}}} = \frac{h}{t_{b}^{id}} = \frac{C_0 \dot{V} / A_R}{q_0\rho_B + C_0 \varepsilon_B}\,.$$</span><br /></p>
<p>For favorable isotherms a self-sharpening effect can be observed <span class="citation" data-cites="Glueckauf.1947">(Glueckauf and Coates 1947)</span>. This means that even an initially flattened concentration front would become vertical again.</p>
<p>The adsorption behavior in fixed bed columns is usually analyzed using so-called breakthrough curves (<span class="smallcaps">btc</span>). These are constructed by measuring the outlet concentration over time and are just a mirrored concentration profile (see sect. <a href="#sec:fixed-bed_results" data-reference-type="ref" data-reference="sec:fixed-bed_results">6.2</a>) but much easier to measure. The axes are related through the travelling velocity of the <span class="smallcaps">mtz</span>. Apart from the general shape there are two values that are used to analyze the breakthrough behavior. The first is the real breakthrough time <span class="math inline"><em>t</em><sub><em>b</em></sub></span>, which is the time at which the outlet concentration first rises and the second is the stoichiometric time <span class="math inline"><em>t</em><sub><em>s</em><em>t</em></sub></span> as an approximation of the ideal breakthrough time.</p>
<p>Diffusion, amongst other factors, leads to a phenomenon called axial dispersion in fixed bed reactors. It will lead to a spreading of the <span class="smallcaps">mtz</span> and therefore a flatter breakthrough curve. Many models, including many implementations of the <span class="smallcaps">ldf</span>, do not include this term. It is however important to keep in mind because we use the advection diffusion equations and diffusion cannot be entirely disregarded. There are ways to include the dispersion in the film diffusion coefficient <span class="citation" data-cites="Raghavan.1983">(Raghavan and Ruthven 1983)</span> to account for this phenomenon in a model.</p>
<h2 id="fluid-dynamics">Fluid Dynamics</h2>
<p>The goal of this thesis is the coupling of fluid dynamics and adsorption dynamics. Therefore, in addition to the adsorption model, we also need a model for the fluid dynamics. All components in the system are described by an Euler approach. They can be described by continuity, momentum and species balances, depending on the type of the transported component.</p>
<h3 id="navier-stokes-equations">Navier-Stokes Equations</h3>
<p>The equations for mass and momentum that describe the fluid, namely the Navier-Stokes equations (<span class="smallcaps">nse</span>), are the following. <br /><span class="math display">$$\frac{\partial \rho}{\partial t} + \nabla\cdot(\rho \boldsymbol{u}) = 0$$</span><br /> This represents the compressible continuity equation with the density <span class="math inline"><em>ρ</em></span> and the fluid velocity <span class="math inline"><strong>u</strong></span>.</p>
<p>The momentum equation is <br /><span class="math display">$$\frac{\partial \rho \boldsymbol{u}}{\partial t} + (\rho \boldsymbol{u}\cdot \nabla) \boldsymbol{u} = -\frac{1}{\rho}\nabla p + \mu \nabla^{2} \boldsymbol{u} + \boldsymbol{F}\,,$$</span><br /> with the pressure <span class="math inline"><em>p</em></span>, the viscosity <span class="math inline"><em>μ</em></span> and a force <span class="math inline"><strong>F</strong></span>. This single equation in Einstein notation stands for up to three equations, one for every dimension of the problem. These equations represent the compressible <span class="smallcaps">nse</span>.</p>
<p>Often the assumption <span class="math inline"><em>ρ</em> = <em>c</em><em>o</em><em>n</em><em>s</em><em>t</em>.</span> is made, which leads to the incompressible variants of the continuity equation <br /><span class="math display">∇ ⋅ <strong>u</strong> = 0</span><br /> and the momentum equation <br /><span class="math display">$$\label{eq:navier}
    \frac{\partial \boldsymbol{u}}{\partial t} + (\boldsymbol{u}\cdot \nabla) \boldsymbol{u} = -\frac{1}{\rho}\nabla p + \nu \nabla^{2} \boldsymbol{u} + \boldsymbol{F}\,,$$</span><br /> now with the kinematic viscosity <span class="math inline"><em>ν</em></span>. The <span class="smallcaps">lbm</span> actually solves a weakly compressible <span class="smallcaps">nse</span> <span class="citation" data-cites="Kruger.2017">(Krüger et al. 2017)</span> because density is in fact variable.</p>
<p>To close the system of equations, we also need an equation of state. A common example for fluids is the isothermal equation of state <br /><span class="math display"><em>p</em> = <em>ρ</em><em>R</em><em>T</em><sub>0</sub> = <em>ρ</em><em>c</em><sub><em>s</em></sub><sup>2</sup> ,</span><br /> with <span class="math inline"><em>c</em><sub><em>s</em></sub></span> as the speed of sound.</p>
<h4 id="volume-averaged-navier-stokes-equations">Volume Averaged Navier Stokes Equations</h4>
<p>In order to describe dense particle flows more accurately without having to deal with the particle-fluid interface in detail, an averaging procedure can be employed. This achieves a two-way coupling between the fluid and the particles. The basic idea is to find equations describing the relevant fluid properties in a volume around an arbitrary point in space <span class="math inline"><strong>x</strong></span> with the averaged influence of particles included. To that end an averaging operator <span class="math inline">⟨⋯⟩</span> is introduced. Following Whitaker<span class="citation" data-cites="Whitaker.1997">(Whitaker 1997)</span> and Enwald<span class="citation" data-cites="Enwald.1996">(Enwald, Peirano, and Almstedt 1996)</span>, the volume average is used: <br /><span class="math display">$$\langle \cdots \rangle = \frac{1}{V_f} \int_{\mathrm{V_f}} \cdots \,dV \,.$$</span><br /> Both an intrinsic and a superficial average are used with the porosity as a conversion factor. As an example, the superficial average over just the volume of fluid, indicated by a phase indicator function <span class="math inline"><em>χ</em></span>, is the fluid volume fraction <span class="math inline"><em>ε</em></span>: <br /><span class="math display">⟨<em>χ</em>⟩ = <em>ε</em> .</span><br /> The phase indicator function <span class="math inline"><em>χ</em>(<em>x</em>)</span> for the phase <span class="math inline"><em>A</em></span> is <span class="math inline">1</span> if <span class="math inline"><em>x</em> ∈ <em>A</em></span> and <span class="math inline">0</span> otherwise.</p>
<p>Applying the procedure to the <span class="smallcaps">nse</span>, the resulting volume averaged equations (<span class="smallcaps">vanse</span>) are as follows <span class="citation" data-cites="Whitaker.2013 Enwald.1996">(Whitaker 2013; Enwald, Peirano, and Almstedt 1996)</span>. <br /><span class="math display">$$\frac{\partial \varepsilon \rho}{\partial t} = \nabla \cdot (\varepsilon \rho \langle\boldsymbol{u}\rangle)$$</span><br /> <br /><span class="math display">$$\frac{\partial \varepsilon \rho \langle\boldsymbol{u}\rangle}{\partial t} + (\varepsilon \rho \langle\boldsymbol{u}\rangle \cdot\nabla)\langle\boldsymbol{u}\rangle = -\varepsilon\nabla \langle p \rangle + \mu \nabla^2 (\varepsilon\langle\boldsymbol{u}\rangle) + \varepsilon \boldsymbol{F}$$</span><br /> The force term <span class="math inline"><strong>F</strong></span> includes amongst body forces also an additional term that represents the back coupling from the particles and which has to be modelled <span class="citation" data-cites="Hocker.2018">(Höcker et al. 2018)</span>. Volume averaging of the <span class="smallcaps">ade</span> works similarly but without any new forcing tems <span class="citation" data-cites="Wood.2003 Maier.2021">(Wood et al. 2003; Maier 2021)</span>.</p>
<h3 id="solute">Solute</h3>
<p>The dissolved adsorbate is described by its own species mass balance <span class="citation" data-cites="Micale.2021 Vandewalle.2021">(Micale et al. 2021; Vandewalle, Marin, and van Geem 2021)</span> in the advection diffusion reaction equation (<span class="smallcaps">adre</span>) <br /><span class="math display">$$\label{eq:adv-diff}
    \frac{\partial C }{\partial t} + \nabla \cdot \left( C \boldsymbol{u}\right) = \nabla \cdot\left(D \nabla C \right) + s$$</span><br /> with <span class="math inline"><em>C</em></span> as the concentration and <span class="math inline"><em>s</em></span> as a source term. It combines an advective component in the second term on the left-hand side and a diffusive term on the right-hand side with the diffusion constant <span class="math inline"><em>D</em></span>.</p>
<p>The source term <span class="math inline"><em>s</em> = <em>ṁ</em><sub><em>a</em><em>d</em><em>s</em></sub></span> comes from the change <span class="math inline"><em>d</em><em>C</em>/<em>d</em><em>t</em></span> in a volume element as introduced in section <a href="#sec:batch_reactor" data-reference-type="ref" data-reference="sec:batch_reactor">4.1.6</a>.</p>
<p>The <span class="smallcaps">adre</span> has a very similar structure as the incompressible <span class="smallcaps">nse</span> with <br /><span class="math display"><em>ρ</em><strong>u</strong> → <em>C</em>, <em>ρ</em><strong>u</strong><strong>u</strong> + <em>p</em><strong>I</strong> → <em>C</em><strong>u</strong>, <em>ν</em> → <em>D</em>, <strong>F</strong> → <em>s</em></span><br /> which makes it a great candidate to be solved by the lattice Boltzmann method as well.</p>
<h3 id="particles">Particles</h3>
<h4 id="particle-density">Particle density</h4>
<p>The moving adsorbent particles are described by the advection diffusion equation, meaning they are not resolved individually but represented by a particle concentration <span class="math inline"><em>ρ</em><sub><em>B</em></sub>(<em>x</em>)</span>. The symbol of <span class="math inline"><em>ρ</em><sub><em>B</em></sub></span> is rooted in the common usage of bulk density in adsorption literature, which is the same as a particle concentration, although usually not treated as a transportable property. The advection diffusion equation (<span class="smallcaps">ade</span>) for the particles is <br /><span class="math display">$$\frac{\partial  \rho_B }{\partial t} + \nabla \cdot \left( \rho_B \boldsymbol{u}_p\right) = \nabla \cdot\left(D \nabla \rho_B \right) + \boldsymbol{F}\,,$$</span><br /> where <span class="math inline"><em>D</em></span> is a diffusion coefficient, <span class="math inline"><strong>u</strong><sub><em>p</em></sub></span> the particle velocity and <span class="math inline"><strong>F</strong></span> a force term. We use <span class="math inline"><em>ρ</em><sub><em>B</em></sub></span> as a measure of mass of particles per volume of flow, as opposed to <span class="math inline"><em>ρ</em><sub><em>p</em></sub></span>, which is the material density of the particles. Their motion is coupled to that of the fluid through the fluid velocity <span class="math inline"><strong>u</strong><sub><em>f</em></sub></span> which is calculated using the <span class="smallcaps">nse</span>. While for very small particles it is reasonable to simply use the fluid velocity as the particle velocity, another approach is the use of a force term <span class="math inline"><strong>F</strong></span> that depends on the fluid velocity to calculate the particle velocity. One choice for the force term is for example Stokes’ drag force <span class="citation" data-cites="Trunk.2016">(Trunk et al. 2016)</span> with <br /><span class="math display"><strong>F</strong><sub><em>S</em><em>t</em></sub> = 6<em>π</em><em>ρ</em><em>ν</em><em>r</em><sub><em>p</em></sub>(<strong>u</strong><sub><em>f</em></sub> − <strong>u</strong><sub><em>p</em></sub>)</span><br /> where <span class="math inline"><strong>u</strong><sub><em>f</em></sub></span> is the fluid velocity and <span class="math inline"><strong>u</strong><sub><em>p</em></sub></span> the particle velocity.</p>
<h4 id="particle-loading">Particle loading</h4>
<p>In addition to the particle density we also track the particle loading <span class="math inline"><em>q̄</em></span>, as described in section <a href="#linear driving force" data-reference-type="ref" data-reference="linear driving force">4.1.3</a> with <br /><span class="math display">$$\frac{\partial \bar{q}}{\partial t}+\nabla \cdot\left(\bar{q} \boldsymbol{u}\right) - \nabla \cdot\left(D \nabla \bar{q} \right) = \rho_p\, \dot{m}_{\mathrm{ads}}\,.$$</span><br /> Here we also have a source term <span class="math inline"><em>ṁ</em><sub>ads</sub></span> that represents the change in loading from adsorption. It is the same as the source term in the solute transport equation but with an additional factor of the particle density, since the loading is spread amongst the particles.</p>
<p>The inclusion of diffusion for the particles makes the model a dispersive one. The coefficient <span class="math inline"><em>D</em></span> can include contributions from different mechanisms, such as diffusion, mixing etc. This makes it possible to be solved using the lattice Boltzmann method. Depending on the particle size it may be more desirable to have no diffusion at all. This can only be approximated by a very small diffusion coefficient <span class="math inline"><em>D</em></span>. How this can be acheived will be picked up again in section <a href="#sec:stability" data-reference-type="ref" data-reference="sec:stability">5.3.4</a>.</p>
<h1 id="model">Model</h1>
<h2 id="dimensionless-quantities">Dimensionless Quantities</h2>
<p>Dimensionless quantities are a useful tool in engineering, especially when comparing systems of different scales or materials. In the following sections, the dimensionless quantities that can be used to describe adsorption systems as encountered in this thesis are introduced.</p>
<h4 id="reynolds-number">Reynolds Number</h4>
<p>Arising from the <span class="smallcaps">nse</span> through non-dimensionalization, the Reynolds number <br /><span class="math display">$$\mathit{Re} = \frac{u L}{\varepsilon_B\, \nu}$$</span><br /> is the quotient of inertial forces to viscous forces. It contains the fluid velocity <span class="math inline"><em>u</em></span>, a characteristic length <span class="math inline"><em>L</em></span>, the dynamic viscosity <span class="math inline"><em>ν</em></span> and optionally the bed porosity <span class="math inline"><em>ε</em><sub><em>B</em></sub></span>. It can be used to gauge whether the flow is laminar or turbulent.</p>
<p>Care has to be taken when choosing the characteristic length <span class="math inline"><em>L</em></span>. Because the choice is in principle arbitrary, it can differ between types of flows and publications. A common definition for flow in a pipe, for example, is the diameter of the pipe and for flow in porous media the particle diameter is often used.</p>
<h4 id="schmidt-number">Schmidt Number</h4>
<p>The Schmidt number <br /><span class="math display">$$\mathit{Sc} = \frac{\nu}{D_L}\,,$$</span><br /> with the fluid viscosity <span class="math inline"><em>ν</em></span> and the diffusion constant <span class="math inline"><em>D</em><sub><em>L</em></sub></span> of a particular solute in the fluid describes the relative importance of momentum diffusivity compared to mass diffusivity. It can be seen as the ratio of the thickness of hydrodynamic layer and the mass-transfer boundary layer.</p>
<h4 id="péclet-number">Péclet Number</h4>
<p>The quotient of advective transport and diffusive transport is called Péclet number. For mass transfer it is defined as <br /><span class="math display">$$Pe = \frac{u L}{D_L} = \mathit{Re}\, \mathit{Sc}$$</span><br /> and can be also be formed from the product of the Reynolds number and Schmidt number. The Péclet number is for example used in fixed bed reactors to quantify the influence of axial dispersion on the result. For values over 40 the reactor can be assumed to exhibit plug flow behavior <span class="citation" data-cites="Raghavan.1983">(Raghavan and Ruthven 1983)</span>.</p>
<h4 id="sherwood-number">Sherwood Number</h4>
<p>Estimation of film mass transfer coefficients is often done using the Sherwood number <span class="math inline"><em>S</em><em>h</em></span>. It is the quotient of the convective diffusion rate and the diffusion rate <br /><span class="math display">$$\mathit{Sh} = \frac{k_f d_p}{D_L}\,.$$</span><br /> Several equations exist to correlate the Sherwood number with the Reynolds and Schmidt numbers. An overview of the many correlations can for example be found in Worch <span class="citation" data-cites="Worch.2021">(Worch 2021)</span>.</p>
<h4 id="biot-number">Biot Number</h4>
<p>The Biot number, originally defined for heat transfer problems, can also be used for mass transfer. In this case it is defined as <br /><span class="math display">$$\mathit{Bi} =\frac{ k_f r_p C_o}{D_s \rho_p q_e}$$</span><br /> and describes the ratio of surface diffusion and film diffusion. If it is larger than 50, film diffusion is negligible, for <span class="math inline"><em>B</em><em>i</em> &lt; 0.5</span> film diffusion is dominant <span class="citation" data-cites="Worch.2021">(Worch 2021)</span>.</p>
<h2 id="adsorption-model">Adsorption Model</h2>
<p>As previously mentioned, we use an Euler-Euler approach to describe the different components in the model. The equations for the particle and species transport are the advection diffusion equations with an added source term. They resemble the <span class="smallcaps">nse</span> in structure and can be solved with an adapted lattice Boltzmann method as shown in <span class="citation" data-cites="Hocker.2018">(Höcker et al. 2018)</span>.</p>
<p>The source term which models the adsorption process stems from the mass equation of the adsorption model. We have chosen the linear driving force model for the numerical calculations primarily because of its simplicity. The main advantage is that, because no concentration gradients inside the particle are involved in the model, a single quantity describing the state of the particle is sufficient. This makes it easily applicable to the Euler-Euler approach with moving particles, where this single quantity can be transported. The other quantity in the model, surface loading, can be calculated for each time step from the surrounding fluid.</p>
<p>The combination of the <span class="smallcaps">ade</span> and adsorption source terms for the linear driving force model results in the following equations. Without film diffusion: <br /><span class="math display">$$\label{eq:LDF-system}
\begin{gathered}
    \dot{m}_{\mathrm{int}} = \frac{3 k_s}{r_p} \left(\rho_B q_s - C_{\bar{q}}\right)\,,\\
    \frac{\partial C }{\partial t} + \nabla \cdot \left( C \boldsymbol{u}\right) = \nabla \cdot\left(D_e \nabla C \right) - \frac{1}{\varepsilon}\dot{m}_{\mathrm{int}}\,,\\
    \frac{\partial C_{\bar{q}}}{\partial t}+\nabla \cdot\left( C_{\bar{q}} \boldsymbol{u}_p \right) = \dot{m}_{\mathrm{int}}\,,\\
    q_s = f(C_s)\,,\\
    C_s = C\,,
\end{gathered}$$</span><br /> where <span class="math inline"><em>C</em><sub><em>q̄</em></sub></span> denotes the particle loading per volume of fluid as opposed to per mass of adsorbents as it is usually done when the mass of the available adsorbent is constant. The conversion is simply <span class="math inline"><em>C</em><sub><em>q̄</em></sub> = <em>ρ</em><sub><em>B</em></sub><em>q̄</em></span>. This is done because the model includes the transport of adsorbed mass by moving particles, so using a volumetric mass density is more appropriate. The factor to convert from reactor volume to adsorbent volume <span class="math inline">1/<em>ε</em></span> is only implemented when using the <span class="smallcaps">vans</span> equations.</p>
<p>The last equation in <a href="#eq:LDF-system" data-reference-type="eqref" data-reference="eq:LDF-system">[eq:LDF-system]</a> is the boundary condition for <span class="math inline"><em>C</em><sub><em>s</em></sub></span> in the case of no film diffusion. With film diffusion we replace the boundary condition for <span class="math inline"><em>C</em><sub><em>s</em></sub></span> with <br /><span class="math display"><em>k</em><sub><em>s</em></sub>(<em>ρ</em><sub><em>B</em></sub><em>q</em><sub><em>s</em></sub> − <em>C</em><sub><em>q̄</em></sub>) = <em>k</em><sub><em>f</em></sub>(<em>C</em> − <em>C</em><sub><em>s</em></sub>) .</span><br /> If external mass transfer is included, the boundary condition for the surface concentration and loading has to be solved numerically, since it is implicit. The Newton method has been used in literature <span class="citation" data-cites="Souza.2017">(Souza, Dotto, and Salau 2017)</span> to solve this, a C implementation of MATLAB’s <em>fsolve</em> function <span class="citation" data-cites="Cowell.1984">(Cowell 1984)</span> is used in this thesis.</p>
<p>The coupling of the different lattices and equations is shown in fig. <a href="#fig:adsorption_scheme" data-reference-type="ref" data-reference="fig:adsorption_scheme">[fig:adsorption_scheme]</a>.</p>
<figure>
<img src="figures/adsorption_flow" alt="Adsorption model flow diagram" style="width:50.0%" /><figcaption>Adsorption model flow diagram</figcaption>
</figure>
<p><span id="fig:adsorption_scheme" label="fig:adsorption_scheme">[fig:adsorption_scheme]</span></p>
<p>Hexagons mark the four different lattices used in the model and the rounded rectangles stand for the equations or quantities involved. The top part depicts the adsorption coupling and the lower part the velocity coupling.</p>
<h3 id="sec:nondimensionalization">Nondimensionalization</h3>
<p>The adsorption equations can be converted to a dimensionless form. In some cases this makes it possible to find analytical solutions. We define the dimensionless concentration <span class="math inline"><em>X</em></span> and loading <span class="math inline"><em>Y</em></span> using the inlet concentration <span class="math inline"><em>C</em><sub>0</sub></span> and the corresponding equilibrium loading <span class="math inline"><em>q</em><sub>0, <em>e</em><em>q</em></sub></span> as <br /><span class="math display">$$X = \frac{C}{C_0}, \quad Y = \frac{q}{q_{0, \mathrm{eq}}}\,.$$</span><br /></p>
<p>The dimensionless Freundlich isotherm is then <br /><span class="math display"><em>Y</em> = <em>X</em><sup><em>n</em></sup> ,</span><br /> and the Langmuir isotherm <br /><span class="math display">$$Y = \frac{X}{R + (1-R) X}\,,$$</span><br /> with the separation factor <br /><span class="math display">$$R = \frac{X (1-Y)}{Y (1-X)} = \frac{1}{1 + b\,C_0}\,.$$</span><br /> We can also apply the separation factor to the Freundlich isotherm and get <br /><span class="math display">$$R = \frac{X^{1-n} - X}{1-X}$$</span><br /> which now depends on the concentration <span class="math inline"><em>X</em></span>. For adsorption models in which a constant <span class="math inline"><em>R</em></span> is assumed, a mean value has to be used.</p>
<p>Using these dimensionless quantities, the mass balance now reads <br /><span class="math display"><em>X</em> + <em>D</em><sub><em>b</em></sub> <em>Ȳ</em> = 1 ,</span><br /> with the distribution factor <br /><span class="math display">$$D_b = \frac{m_A\, q_{0,\mathrm{eq}}}{V_L\, C_0}$$</span><br /> and the mass transfer equation <br /><span class="math display">$$\frac{d \bar{Y}}{d T} = Y_s - \bar{Y}\,.$$</span><br /></p>
<p>These equations are used for the analytical solutions. For the simulation we have to rely on the original equations, because the time step of the adsorption equations has to match that of the fluid simulation. The conversions done there are explained in section <a href="#sec:implementation" data-reference-type="ref" data-reference="sec:implementation">5.4</a>.</p>
<h2 id="lattice-boltzmann-model">Lattice Boltzmann Model</h2>
<p>The equations in chapter <a href="#chap:theory" data-reference-type="ref" data-reference="chap:theory">4</a> can in principle be solved numerically by a number of different methods. For this thesis the lattice Boltzmann method was chosen. It recovers the Navier-Stokes equations but using a different approach than traditional solvers and is a so-called mesoscopic approach, as it deals with particle populations which can be understood to lie in between the macroscopic <span class="smallcaps">nse</span> and the microscopic particle kinetics. Instead of solving the <span class="smallcaps">nse</span> directly, it numerically solves the Boltzmann equation. The macroscopic <span class="smallcaps">nse</span> can be recovered in a separate step.</p>
<p>The unique approach behind the <span class="smallcaps">lbm</span> is the discretization in space, time and velocity space. The discrete velocity distribution function <span class="math inline"><em>f</em><sub><em>i</em></sub>(<strong>x</strong>, <em>t</em>)</span> can be thought of as a particle density function for particles with discrete velocities, also called populations. Only a certain set of velocities <span class="math inline"><strong>c</strong><sub><em>i</em></sub></span> is allowed which all lead to neighboring lattice nodes. They are chosen so that a particle would travel from one node to the next in exactly one time step. Starting with the Boltzmann equation and after discretization of space, time and velocity we get <br /><span class="math display"><em>f</em><sub><em>i</em></sub>(<strong>x</strong> + <strong>c</strong><sub><em>i</em></sub><em>Δ</em><em>t</em>, <em>t</em> + <em>Δ</em><em>t</em>) = <em>f</em><sub><em>i</em></sub>(<strong>x</strong>, <em>t</em>) + <em>Ω</em><sub><em>i</em></sub>(<strong>x</strong>, <em>t</em>)<em>Δ</em><em>t</em> ,</span><br /> with the collision operator <span class="math inline"><em>Ω</em><sub><em>i</em></sub>(<strong>x</strong>, <em>t</em>)</span>. This is known as the lattice Boltzmann equation.</p>
<p>This equation only deals with populations, but we also need to recover the macroscopic quantities. They can be calculated by taking moments of the distribution functions. The zeroth moment gives density and the first moment gives momentum: <br /><span class="math display">$$\begin{aligned}
    \rho &amp;= \sum_{i}^{}f_i &amp; \rho u &amp;= \sum_{i}^{}\boldsymbol{c}_i f_i\,. \label{eq:moments}\end{aligned}$$</span><br /> The second moment is defined as <br /><span class="math display"><strong>Π</strong> = ∑<sub><em>i</em></sub><strong>c</strong><sub><em>i</em></sub><strong>c</strong><sub><em>i</em></sub><em>f</em><sub><em>i</em></sub></span><br /> and is related to the stress tensor.</p>
<p>Analysis of the <span class="smallcaps">lbm</span> through a Chapman-Enskog expansion and comparison with the <span class="smallcaps">nse</span> reveals that the Navier-Stokes equations can indeed be recovered with the viscosity being connected to the relaxation time <span class="math inline"><em>τ</em></span> of the collision operator by <br /><span class="math display">$$\nu = c_{s}^2 \left(\tau - \frac{\Delta t}{2}\right)$$</span><br /> with <span class="math inline"><em>c</em><sub><em>s</em></sub></span> as the speed of sound. <span class="citation" data-cites="Kruger.2017">(Krüger et al. 2017)</span> The equation of state for the <span class="smallcaps">lbe</span> is <span class="math inline"><em>p</em> = <em>c</em><sub><em>s</em></sub><sup>2</sup><em>ρ</em></span>.</p>
<p>The structure of eq. <a href="#eq:lattice-boltzman" data-reference-type="eqref" data-reference="eq:lattice-boltzman">[eq:lattice-boltzman]</a> lends itself to the separation into a streaming step and a collision step. This is also how most solvers are implemented. The populations are propagated to neighboring nodes according to their velocities in the streaming step, this is represented by the left-hand side of <a href="#eq:lattice-boltzman" data-reference-type="eqref" data-reference="eq:lattice-boltzman">[eq:lattice-boltzman]</a>. In the collision step new population densities are calculated using the collision operator. This step can usually be a local operation, meaning no neighboring nodes need to be accessed. The <span class="smallcaps">lbm</span> is therefore easily parallelized.</p>
<h4 id="bgk-collision-operator">BGK-Collision Operator</h4>
<p>An important contribution to recovering physical behavior is the collision operator. Using the fairly simple <span class="smallcaps">bgk</span> operator the <span class="smallcaps">nse</span> can be recovered. It is defined as <br /><span class="math display">$$\Omega_i = -\frac{f_i-f_i^{eq}}{\tau}\,.%\Delta t$$</span><br /> This collision operator can be viewed as a relaxation of the populations <span class="math inline"><em>f</em><sub><em>i</em></sub></span> towards an equilibrium given by <br /><span class="math display">$$f_i^{eq}(\boldsymbol{x},t) = w_i \rho \left(1 + \frac{\boldsymbol{c_i}\cdot\boldsymbol{u}}{c_s^2} + \frac{(\boldsymbol{u}\cdot \boldsymbol{c}_i)^2}{2c_s^4} - \frac{\boldsymbol{u}\cdot \boldsymbol{u}}{2c_s^2}\right)\,.$$</span><br /> The rate of relaxation is given by the relaxation time <span class="math inline"><em>τ</em></span>. Weights <span class="math inline"><em>w</em><sub><em>i</em></sub></span> are used, which are specific to each velocity set. The macroscopic variables that are included in the equilibrium are computed according to eq. <a href="#eq:moments" data-reference-type="eqref" data-reference="eq:moments">[eq:moments]</a>. An important property of the equilibrium is that its moments are the same as those of the populations <span class="math inline"><em>f</em><sub><em>i</em></sub></span> themselves.</p>
<p>Other operators, like <span class="smallcaps">trt</span> (two relaxation times) and <span class="smallcaps">mrt</span> (multiple relaxation times) are available and can bring accuracy and stability improvements.</p>
<h4 id="discretization-and-lattice-units">Discretization and Lattice Units</h4>
<p><span class="smallcaps">lbm</span> uses a square lattice with the lattice spacing <span class="math inline"><em>Δ</em><em>x</em></span>. Most commonly lattice units are used in the simulation, where <span class="math inline"><em>Δ</em><em>x</em><sup>⋆</sup> = <em>Δ</em><em>t</em><sup>⋆</sup> = 1</span>. This has the advantage of also making the problem dimensionless, which is always recommended for fluid simulations. The chosen conversions may however be different from conventional <span class="smallcaps">nse</span> solvers. Three conversion factors denoted by <span class="math inline">𝒞</span> are needed to form a valid unit system. All other conversions can be derived from those. Commonly we set <span class="math inline"><em>Δ</em><em>x</em><sup>⋆</sup></span>, <span class="math inline"><em>Δ</em><em>t</em><sup>⋆</sup></span> and <span class="math inline"><em>ρ</em><sup>⋆</sup></span> to unity and get the conversion factors <br /><span class="math display">𝒞<sub><em>l</em></sub> = <em>Δ</em><em>x</em>, 𝒞<sub><em>t</em></sub> = <em>Δ</em><em>t</em> <em>a</em><em>n</em><em>d</em> 𝒞<sub><em>ρ</em></sub> = <em>ρ</em> .</span><br /> The lattice relaxation time <span class="math inline"><em>τ</em><sup>⋆</sup></span> is related to the relaxation time by <span class="math inline"><em>τ</em> = 𝒞<sub><em>t</em></sub> <em>τ</em><sup>⋆</sup></span>. In most cases the lattice relaxation time is used in the following sections, especially when listing actual values, but the star notation has been omitted.</p>
<h4 id="velocity-sets">Velocity Sets</h4>
<p>The velocity space in <span class="smallcaps">lbm</span> is discretized with a set of velocities <span class="math inline"><strong>c</strong><sub><em>i</em></sub></span>. The nomenclature for these sets usually follows the scheme of <span class="math inline"><em>D</em><em>d</em><em>Q</em><em>q</em></span> with <span class="math inline"><em>d</em></span> denoting the number of spatial dimensions and <span class="math inline"><em>q</em></span> the number of discrete velocities. Several sets are available, depending on the application. They represent discrete directions in which particles can move.</p>
<p>For example, the <em>D3Q7</em> velocity set includes the directions perpendicular to the faces of a cube with the lattice node at its center plus the zero velocity. In this case we would need two sets of weights <span class="math inline"><em>w</em><sub><em>i</em></sub></span>, one for the zero velocity and one for all the others, since their vectors have the same length. Other common velocity set for two dimensions are <em>D2Q9</em> and <em>D3Q19</em> for 3D. In these cases there are several sets of weights, as the velocity vectors are of different lengths.</p>
<p>There is a trade-off between computational cost and accuracy, both increase for larger sets. For advection diffusion we can actually use fewer velocities, which is why <em>D3Q7</em> is used in this thesis.</p>
<p>The speed of sound depends on the velocity set and for most <span class="math inline">$c_{s}^\star = \sqrt{\sfrac{1}{3}}$</span>. However, for the lattice <em>D3Q7</em> it is different from the standard with <span class="math inline">$c_{s,\textsc{\MakeLowercase{ADE}}}^\star = \sqrt{\sfrac{1}{4}}$</span>.</p>
<h3 id="advection-diffusion">Advection Diffusion</h3>
<p>The discretization of the advection diffusion reaction equation follows the example of the <span class="smallcaps">nse</span>, which can easily be justified by their very similar forms. Following the same discretization procedure we get <br /><span class="math display"><em>g</em><sub><em>i</em></sub>(<strong>x</strong> <strong>+</strong> <strong>c</strong><sub><strong>i</strong></sub><em>Δ</em><em>t</em>, <em>t</em> + <em>Δ</em><em>t</em>) − <em>g</em><sub><em>i</em></sub>(<strong>x</strong>, <em>t</em>) = <em>Ω</em><sub><em>i</em></sub>(<strong>x</strong>, <em>t</em>) + <em>Δ</em><em>t</em> <em>S</em><sub><em>i</em></sub>(<strong>x</strong>, <em>t</em>) ,</span><br /> where <span class="math inline"><em>S</em><sub><em>i</em></sub></span> is a suitable source term that fulfills the condition <span class="math inline">∑<sub><em>i</em></sub><em>S</em><sub><em>i</em></sub> = <em>s</em></span>.</p>
<p>The collision operator <span class="math inline"><em>Ω</em><sub><em>i</em></sub></span> also follows the <span class="smallcaps">bgk</span> approach <br /><span class="math display">$$\Omega_i = -\frac{1}{\tau}\left(g_i - g_i^{eq}\right)\,,$$</span><br /> with the equilibrium defined as <br /><span class="math display">$$g_{i}^{\mathrm{eq}}=w_{i} C\left(1+\frac{\boldsymbol{c}_{i} \cdot \boldsymbol{u}}{c_{\mathrm{s}}^{2}}+\frac{\left(\boldsymbol{c}_{i} \cdot \boldsymbol{u}\right)^{2}}{2 c_{\mathrm{s}}^{4}}-\frac{\boldsymbol{u} \cdot \boldsymbol{u}}{2 c_{\mathrm{s}}^{2}}\right)\,$$</span><br /> with the concentration <span class="math inline"><em>C</em></span>.</p>
<p>Instead of the viscosity, we have the diffusion coefficient <span class="math inline"><em>D</em></span> which is defined similarly: <br /><span class="math display">$$\label{eq:adv-diff-diffusion_constant}
    D = c_{s}^2 \left(\tau_g - \frac{\Delta t}{2}\right)\,.$$</span><br /></p>
<p>The concentration can be obtained from the zeroth moment of the advection diffusion equations <span class="citation" data-cites="Anderl.2014">(Anderl et al. 2014)</span> <br /><span class="math display"><em>C</em> = ∑<sub><em>i</em></sub><em>g</em><sub><em>i</em></sub> .</span><br /> This is the only moment that is conserved, momentum is not, so the velocity has to be calculated using the <span class="smallcaps">nse</span>, or <span class="smallcaps">lbe</span> in our case. For this reason a lattice with only a few discrete velocities is sufficient but often higher isotropy lattices are used anyway <span class="citation" data-cites="Kruger.2017">(Krüger et al. 2017)</span>.</p>
<p>With the addition of a source term, some redefinitions have to be made. A Chapman-Enskog analysis reveals an unwanted term <span class="citation" data-cites="Seta.2013">(Seta 2013)</span> that can be eliminated by setting <br /><span class="math display">$$\label{eq:lattice_ADE_definitions}
    C = \sum_i g_i + \frac{S_i \Delta t}{2}\quad \mathrm{and} \quad S = \left(1-\frac{1}{2\tau_g}\right)w_i s$$</span><br /> similarly to the approach used for the <span class="smallcaps">lbe</span> with a force term <span class="citation" data-cites="Guo.2002">(Guo and Zhao 2002)</span>.</p>
<h3 id="boundary-conditions">Boundary Conditions</h3>
<p>Boundary conditions are required in all attempts to solve differential equations. First the general types of boundary conditions are introduced and afterwards their specific implementations for the <span class="smallcaps">lbm</span> are shown.</p>
<h4 id="first-order">First Order</h4>
<p>A first order boundary condition, also known as Dirichlet boundary condition, sets the missing value <span class="math inline"><em>y</em></span> according to some function <span class="math inline"><em>f</em></span>: <br /><span class="math display"><em>y</em> = <em>f</em> .</span><br /> In the context of thermal advection diffusion this is also called temperature boundary. The equivalent in our case is concentration. This type is often used at inlets.</p>
<h4 id="second-order">Second Order</h4>
<p>Instead of the value itself, the Neumann boundary condition sets the normal derivative at the boundary: <br /><span class="math display">$$\frac{\partial y}{\partial n} = f\,.$$</span><br /> In thermal advection diffusion this is called a heat flux boundary. For advection diffusion concerned with mass transport, a Neumann boundary sets mass transport through diffusion to zero, but does not affect advection <span class="citation" data-cites="Lynch.2020">(Lynch et al. 2020)</span>.</p>
<h4 id="lattice-boltzmann-boundaries">Lattice Boltzmann boundaries</h4>
<p>The lattice Boltzmann method poses some unique challenges when it comes to boundaries. In general the aim is to find values for the undefined populations that are entering the domain. One of the simplest boundary implementations is called bounce back, where the outgoing populations are simply used as incoming populations. This results in a no-slip boundary.</p>
<p>A periodic boundary is realized by using the populations that exit at one side of the domain as the entering populations on the other side.</p>
<p>A velocity boundary can be implemented using a bounce back approach with an additional term that includes the velocity at the wall <span class="math inline"><strong>u</strong><sub><em>w</em></sub></span>: <br /><span class="math display">$$f_i (\boldsymbol{x}_b, t + \Delta t) = f_i^*(\boldsymbol{x}_b, t) - 2 w_i \rho_w \frac{\boldsymbol{c}_i \boldsymbol{u}_w}{c_s^2}\,,$$</span><br /> where <span class="math inline"><strong>x</strong><sub><em>b</em></sub></span> is the boundary node’s position.</p>
<p>Pressure boundaries can be realized with an anti-bounce-back approach where the sign of bounced back populations is changed <span class="citation" data-cites="Kruger.2017">(Krüger et al. 2017)</span>. The equation has a similar structure as the velocity boundary. The difficulty here lies in the estimation of the density <span class="math inline"><em>ρ</em><sub><em>w</em></sub></span> and the velocity <span class="math inline"><strong>u</strong><sub><em>w</em></sub></span>.</p>
<h3 id="accuracy">Accuracy</h3>
<p>Different error sources contribute to the overall error of a simulation. An obvious error in any discretized equation is the truncation error, which should tend to zero when <span class="math inline"><em>Δ</em><em>x</em></span> and <span class="math inline"><em>Δ</em><em>t</em></span> go towards zero. In a stable system this should also dictate the order of convergence. Generally the <span class="smallcaps">lbm</span> is second order accurate in respect to both temporal and spatial discretization <span class="citation" data-cites="Kruger.2017 Gruszczynski.2021">(Krüger et al. 2017; Gruszczyński, Dzikowski, and Łaniewski-Wołłk 2021)</span>.</p>
<p>One important property of the <span class="smallcaps">lbm</span> is the relation of the viscosity with the lattice relaxation time and discretization steps <br /><span class="math display">$$\nu = c_s^{\star 2} \left(\tau^\star  - \frac{1}{2} \right) \frac{\Delta x^2}{\Delta t}\,,$$</span><br /> which means that viscosity can influence the accuracy of the <span class="smallcaps">bgk</span> model.</p>
<p>Multiple other error terms can contribute to the overall error, such as modelling errors. One example is the compressibility error, which scales with <br /><span class="math display">𝒪(<em>M</em><em>a</em><sup>2</sup>) ∝ 1/<em>c</em><sub><em>s</em></sub><sup>2</sup> ∝ <em>Δ</em><em>t</em><sup>2</sup>/<em>Δ</em><em>x</em><sup>2</sup> .</span><br /> Another is the <span class="smallcaps">bgk</span> truncation error, which scales with <span class="math inline">(<em>τ</em> − 1/2)<sup>2</sup></span>. <span class="citation" data-cites="Kruger.2017">(Krüger et al. 2017)</span></p>
<h4 id="convergence-scaling">Convergence &amp; Scaling</h4>
<p>The main tool to assess the accuracy of discretized equations is the convergence towards the solution measured as the experimental order of convergence (<span class="smallcaps">eoc</span>). It is easier than determining the formal truncation error and is done by reducing <span class="math inline"><em>Δ</em><em>t</em></span> and <span class="math inline"><em>Δ</em><em>x</em></span> successively and measuring the error to a given solution.</p>
<p>The obvious approach is to keep <span class="math inline"><em>Δ</em><em>x</em> ∝ <em>Δ</em><em>t</em></span>, this is called acoustic scaling. Generally, diffusive scaling is used when measuring the order of convergence for <span class="smallcaps">lbm</span>. This is done to keep the compressibility and discretization error of the same order by setting <br /><span class="math display">$$\Delta x^2 \propto \frac{\Delta t^2}{\Delta x^2} \rightarrow  \Delta t \propto \Delta x^2\,,$$</span><br /> which reduces the compressibility and discretization errors simultaneously <span class="citation" data-cites="Junk.2005">(Junk, Klar, and Luo 2005)</span>. This has the consequence of making the <span class="smallcaps">lbm</span> effectively first order accurate in time <span class="citation" data-cites="Kruger.2017">(Krüger et al. 2017)</span>.</p>
<p>The <span class="smallcaps">eoc</span> can be determined using three numerical solutions <span class="math inline"><em>ϕ</em><sub><em>i</em></sub></span> for different mesh sizes with a constant scaling factor <span class="math inline"><em>r</em></span>. If, for example, the number of points is doubled, <span class="math inline"><em>r</em></span> would be 2. The order of convergence is <span class="citation" data-cites="Ferziger.2002">(Ferziger and Perić 2002)</span> <br /><span class="math display">$$\textsc{\MakeLowercase{EOC}} = \frac{\log\left(\frac{\phi_3 -\phi_2}{\phi_2 -\phi_1} \right)}{\log(r)}\,.$$</span><br /> It can also be estimated by the slope of a line fitted to the error in a double logarithmic plot over the grid number.</p>
<h4 id="error-calculation">Error Calculation</h4>
<p>The most common measure of the error between a numerical approximation <span class="math inline"><em>q</em><sub><em>n</em></sub></span> and the known solution <span class="math inline"><em>q</em><sub><em>a</em></sub></span> is the so called <span class="math inline">ℒ<sub>2</sub></span> error norm. The relative error is then calculated as follows: <br /><span class="math display">$$\frac{\left\lVert q_n - q_a \right\rVert_2}{\left\lVert q_a\right\rVert_2} = \sqrt{\frac{\sum_x \left(q_n(x,t) - q_a(x,t)\right)^2}{\sum_x q_a^2(x,t)}}\,.
    \label{eq:L2 error}$$</span><br /></p>
<h3 id="sec:stability">Stability</h3>
<p>The fact that the relaxation time and viscosity or diffusivity, depending on the lattice type, are connected, has consequences for stability considerations.</p>
<p>A necessary stability condition for the <span class="smallcaps">bgk</span> operator is that <span class="math inline">$\tau^\star &gt; \sfrac{1}{2}$</span> <span class="citation" data-cites="Kruger.2017">(Krüger et al. 2017)</span>. There are however several other criteria and boundary conditions which can reduce the stable region considerably. The maximal stable lattice velocity depends on the relaxation time <span class="citation" data-cites="Kruger.2017">(Krüger et al. 2017)</span> but for <span class="math inline"><em>τ</em> &gt; 1</span> the maximum is a constant.</p>
<p>In the case discussed in this thesis the coupling between two types of lattices complicates the choice of parameters. Using the Schmidt number with the definitions of the viscosity and diffusivity in <span class="smallcaps">lbm</span> we get <br /><span class="math display">$$\mathit{Sc} = \frac{\nu}{D} =\frac{c_{s,F}^{\star 2}}{c_{s, \textsc{\MakeLowercase{ADE}}}^{\star 2}} \frac{\Delta t_{\textsc{\MakeLowercase{ADE}}}}{\Delta t_{F}} \frac{(\tau_{F}^\star - 0.5)}{(\tau_{\textsc{\MakeLowercase{ADE}}}^\star - 0.5)}\,.$$</span><br /> Assuming the same <span class="math inline"><em>Δ</em><em>t</em></span> for both lattices, this gives us the matching relaxation times for the <span class="smallcaps">ade</span> and the <span class="smallcaps">nse</span> lattices <br /><span class="math display">$$\tau_{\textsc{\MakeLowercase{NSE}}}^\star = (\tau_{\textsc{\MakeLowercase{ADE}}}^\star - 0.5) \frac{c_{s,\textsc{\MakeLowercase{ADE}}}^{\star,2}}{c_{s,F}^{\star,2}}\,\mathit{Sc} + 0.5\,.$$</span><br /> With the values of <span class="math inline"><em>S</em><em>c</em></span> commonly being up to around 1000, this makes the relation very sensitive to the value of <span class="math inline">$\tau_{\textsc{\MakeLowercase{ADE}}}^\star$</span> and values very close to the minimum of 0.5 are often required.</p>
<p>An alternative approach might be the utilization operator splitting or substeps where the fluid lattice has a larger <span class="math inline"><em>Δ</em><em>t</em></span> than the advection-diffusion lattice, thereby allowing for more control over stability and accuracy. This has for example been proposed by Micale et al. <span class="citation" data-cites="Micale.2021">(Micale et al. 2021)</span> in their simulation of reaction kinetics in fluidized beds.</p>
<h2 id="sec:implementation">Implementation</h2>
<p>The <em>OpenLB</em> library already has dynamics implemented for the fluid and <span class="smallcaps">ade</span> with a source term. The values for the source term are computed in a custom coupler at each time step and saved for each lattice node. In the collision step this source term is then included according to eq. <a href="#eq:lattice_ADE" data-reference-type="eqref" data-reference="eq:lattice_ADE">[eq:lattice_ADE]</a> and eq. <a href="#eq:lattice_ADE_definitions" data-reference-type="eqref" data-reference="eq:lattice_ADE_definitions">[eq:lattice_ADE_definitions]</a>.</p>
<p>The coupling is done as a separate step before collision by a <code>PostProcessor</code>. Its job is to get the required values from the different lattices, calculate the source term and write the new values to the lattices. It utilizes the existing implementation of sourced advection diffusion dynamics in <em>OpenLB</em>. The flow of information was shown in fig. <a href="#fig:adsorption_scheme" data-reference-type="ref" data-reference="fig:adsorption_scheme">[fig:adsorption_scheme]</a></p>
<p>The code was designed to accommodate all the different flavors of the <span class="smallcaps">ldf</span> model, such as with and without film diffusion, different isotherms etc. Fig. <a href="#fig:uml-adsorption" data-reference-type="ref" data-reference="fig:uml-adsorption">5.1</a> shows the classes that were implemented for this project.</p>
<figure>
<img src="figures/adsorption-uml" alt="UML for classes related to adsorption coupling." id="fig:uml-adsorption" style="width:80.0%" /><figcaption>UML for classes related to adsorption coupling.<span label="fig:uml-adsorption"></span></figcaption>
</figure>
<p>Different isotherms can be implemented by inheriting from the <code>Isotherm</code> class, as is shown with the <code>linearIsotherm</code>. The coupling post processor calls the <code>getReactionRate()</code> method in <code>AdsorptionReaction</code> which can use either the pure surface diffusion model or a combined film and surface diffusion model by calling two different overriding methods called <code>getSurfaceLoading()</code>. These two methods take as parameters either only the solute concentration <span class="math inline"><em>C</em></span> or the particle loading <span class="math inline"><em>q</em></span>, the particle concentration <span class="math inline"><em>ρ</em><sub><em>B</em></sub></span> and <span class="math inline"><em>C</em></span>.</p>
<p>Due to the fact, that three different lattices with different densities which potentially differ by orders of magnitude need to be coupled, the choice of units and their consistent use is important. A custom <code>UnitConverter</code> called <code>AdsorptionConverter</code> was therefore implemented. The customary units of the material properties as used in the literature are listed in table <a href="#tab:units" data-reference-type="ref" data-reference="tab:units">[tab:units]</a>.</p>
<table>
<caption>Process parameters</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: left;">Symbol</th>
<th style="text-align: right;">Unit</th>
<th style="text-align: right;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Concentration</td>
<td style="text-align: left;"><span class="math inline"><em>C</em></span></td>
<td style="text-align: right;"><span class="math inline"><em>m</em><em>g</em>/<em>L</em></span></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Loading</td>
<td style="text-align: left;"><span class="math inline"><em>q</em></span></td>
<td style="text-align: right;"><span class="math inline"><em>m</em><em>g</em>/<em>g</em></span></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Density</td>
<td style="text-align: left;"><span class="math inline"><em>ρ</em></span></td>
<td style="text-align: right;"><span class="math inline"><em>k</em><em>g</em>/<em>m</em><sup>3</sup></span></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Length</td>
<td style="text-align: left;"><span class="math inline"><em>L</em></span></td>
<td style="text-align: right;"><span class="math inline"><em>m</em></span></td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
<p><span id="tab:units" label="tab:units">[tab:units]</span></p>
<p>Because the values for particle and solute concentration and loading can differ by orders of magnitudes, the actual simulation is preferably conducted in lattice units to avoid inaccuracies and instabilities. For coupling, the factors in the equations either have to be adjusted or the quantities temporarily converted back. This is done by the accessing the matching conversion factors in the <code>AdsorptionConverter</code>. The choice for the conversion factors for the concentration and particle density is relatively straightforward: <br /><span class="math display">𝒞<sub><em>C</em></sub> = <em>C</em><sub>0</sub>, 𝒞<sub><em>ρ</em></sub> = <em>ρ</em><sub><em>B</em></sub> ,</span><br /> where <span class="math inline"><em>C</em><sub>0</sub></span> is the inlet concentration and <span class="math inline"><em>ρ</em><sub><em>B</em></sub></span> is the bed density, when necessary a particle inlet concentration might be used. The conversion for the loading requires some more thought. We don’t actually use the loading <span class="math inline"><em>q</em></span> but <span class="math inline"><em>C</em><sub><em>q</em></sub></span>, which has the units . There are several factors that determine the maximum occurring loading concentration <span class="math inline"><em>C</em><sub><em>q</em></sub></span> in a simulation, such as the isotherm, solute concentration and particle concentration. Choosing the same factor as for the particle concentration results in values that are of the same magnitude as the corresponding loading <span class="math inline"><em>q</em></span>. So, during simulation we use the conversion <br /><span class="math display"><em>C</em><sub><em>q̄</em></sub> = 𝒞<sub><em>ρ</em></sub> <em>C</em><sub><em>q̄</em></sub><sup>⋆</sup> .</span><br /> It is important to remember however, that, in the case of varying particle density, the actual loading that corresponds to the loading concentration is dependent on the local particle concentration <br /><span class="math display"><em>q̄</em>(<em>x</em>) = <em>ρ</em><sub><em>B</em></sub>(<em>x</em>) <em>C</em><sub><em>q̄</em></sub>(<em>x</em>) .</span><br /></p>
<h1 id="application">Application</h1>
<p>The linear driving force model that was introduced in the previous sections is used in the following section in several simulations to validate its accuracy and demonstrate its practical application. Although the model is applicable without any changes to two- and three-dimensional problems, all simulations were set up in 3D, because its eventual application will be in 3D applications. All simulations were performed using the <em>OpenLB</em> <span class="citation" data-cites="Krause.2021">(Krause et al. 2021)</span> library.</p>
<h2 id="batch-reactor">Batch Reactor</h2>
<p>First we look at the adsorption model itself and solve the equation on its own. It can easily be applied to a batch reactor, where an analytical solution for linear isotherms exists <span class="citation" data-cites="Worch.2021">(Worch 2021)</span> with the dimensionless quantities as defined in sec. <a href="#sec:nondimensionalization" data-reference-type="ref" data-reference="sec:nondimensionalization">5.2.1</a>. Following the linear driving force model, the dimensionless concentration <span class="math inline"><em>X</em></span> evolves over time as <br /><span class="math display">$$X(T) = \frac{1}{D_b + 1} + \frac{D_b}{D_b + 1} \exp{\left(-(D_b+1)T\right)}\,.
    \label{eq:analytical_batch}$$</span><br /> It uses a dimensionless time <span class="math inline"><em>T</em></span> with <br /><span class="math display"><em>T</em> = <em>k</em><sub><em>s</em></sub><sup>*</sup> <em>t</em> .</span><br /></p>
<h3 id="simulation-setup">Simulation Setup</h3>
<p>The batch reactor is realized as a cube with periodic boundaries on all sides. The velocity for all components is zero and we can assume perfect mixing or spatially uniform conditions. This results in a system that simply solves the differential equations for adsorption, without any fluid or particle interactions.</p>
<p>The process parameters and material properties that were used in the simulations are listed in table <a href="#tab:parameters_batch" data-reference-type="ref" data-reference="tab:parameters_batch">[tab:parameters_batch]</a>.</p>
<table>
<caption>Process parameters for batch reactor.</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: center;">Value</th>
<th style="text-align: right;">Unit</th>
<th style="text-align: center;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Isotherm parameter</td>
<td style="text-align: center;"><span class="math inline"><em>K</em></span></td>
<td style="text-align: right;">45</td>
<td style="text-align: center;"><span class="math inline"><em>L</em>/<em>g</em></span></td>
</tr>
<tr class="even">
<td style="text-align: left;">Inlet concentration</td>
<td style="text-align: center;"><span class="math inline"><em>C</em><sub>0</sub></span></td>
<td style="text-align: right;">1</td>
<td style="text-align: center;"><span class="math inline"><em>m</em><em>g</em>/<em>L</em></span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Adsorbent bulk density</td>
<td style="text-align: center;"><span class="math inline"><em>ρ</em><sub><em>B</em></sub></span></td>
<td style="text-align: right;">0.94</td>
<td style="text-align: center;"><span class="math inline"><em>k</em><em>g</em>/<em>m</em><sup>3</sup></span></td>
</tr>
<tr class="even">
<td style="text-align: left;">Adsorbent density</td>
<td style="text-align: center;"><span class="math inline"><em>ρ</em><sub><em>p</em></sub></span></td>
<td style="text-align: right;">1000</td>
<td style="text-align: center;"><span class="math inline"><em>k</em><em>g</em>/<em>m</em><sup>3</sup></span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Column length</td>
<td style="text-align: center;"><span class="math inline"><em>L</em></span></td>
<td style="text-align: right;">0.1</td>
<td style="text-align: center;"><span class="math inline"><em>m</em></span></td>
</tr>
<tr class="even">
<td style="text-align: left;">Particle radius</td>
<td style="text-align: center;"><span class="math inline"><em>r</em><sub><em>p</em></sub></span></td>
<td style="text-align: right;"></td>
<td style="text-align: center;"><span class="math inline"><em>m</em></span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Surface diffusion coefficient</td>
<td style="text-align: center;"><span class="math inline"><em>D</em><sub><em>s</em></sub></span></td>
<td style="text-align: right;"></td>
<td style="text-align: center;"><span class="math inline"><em>m</em><sup>2</sup>/<em>s</em><sup>2</sup></span></td>
</tr>
<tr class="even">
<td style="text-align: left;">Film diffusion coefficient</td>
<td style="text-align: center;"><span class="math inline"><em>D</em><sub><em>f</em></sub></span></td>
<td style="text-align: right;"></td>
<td style="text-align: center;"><span class="math inline"><em>m</em><sup>2</sup>/<em>s</em><sup>2</sup></span></td>
</tr>
</tbody>
</table>
<p><span id="tab:parameters_batch" label="tab:parameters_batch">[tab:parameters_batch]</span></p>
<p>The model can also be made to include film diffusion. That system of equations is shown in eq. <a href="#eq:LDF-system" data-reference-type="eqref" data-reference="eq:LDF-system">[eq:LDF-system]</a> and <a href="#eq:LDF-system-film-boundry" data-reference-type="eqref" data-reference="eq:LDF-system-film-boundry">[eq:LDF-system-film-boundry]</a>. There is an analytical solution for pure film diffusion as well, it is structurally the same as eq. <a href="#eq:analytical_batch" data-reference-type="eqref" data-reference="eq:analytical_batch">[eq:analytical_batch]</a> but with a differently defined dimensionless time <span class="math inline"><em>T</em></span>. In the case of film diffusion <br /><span class="math display">$$T = \frac{k_f^*}{D_b} t$$</span><br /> where, in the style of the surface diffusion coefficient, <span class="math inline">$k_f^* = \frac{3 k_f}{r_p}$</span>. As previously stated, the new boundary condition for the surface concentration has to be solved numerically.</p>
<h3 id="results">Results</h3>
<p>The evolution of the concentration in the reactor <span class="math inline"><em>C</em></span> over time can be seen in fig. <a href="#fig:concentration_batch" data-reference-type="ref" data-reference="fig:concentration_batch">[fig:concentration_batch]</a>. The concentration is homogenous in the entire reactor because we solve an equation that only depends on time.</p>
<p><span id="fig:concentration_batch" label="fig:concentration_batch">[fig:concentration_batch]</span></p>
<p>The top x-axis shows the dimensionless time <span class="math inline"><em>T</em></span>, the bottom axis the time <span class="math inline"><em>t</em></span> in seconds. When using the dimensionless <span class="math inline"><em>T</em></span>, the shape of the curve only depends on the value of <span class="math inline"><em>D</em><sub><em>b</em></sub></span> which, for a linear isotherm, is a function of the slope of the isotherm <span class="math inline"><em>K</em></span> and the bulk density of the adsorbent <span class="math inline"><em>ρ</em><sub><em>B</em></sub></span> alone. Specific kinetics are then introduced through the conversion to time <span class="math inline"><em>t</em></span>.</p>
<p>We get good agreement with the analytical solution of the linear driving force model in eq. <a href="#eq:analytical_batch" data-reference-type="eqref" data-reference="eq:analytical_batch">[eq:analytical_batch]</a> as shown by Worch <span class="citation" data-cites="Worch.2021">(Worch 2021)</span>. This of course only demonstrates the correct implementation of the model and the convergence of the discretized equations towards the model equation. On the topic of the accuracy of the model itself and the validity of the model in the first place, the reader may refer to existing literature <span class="citation" data-cites="HASHIMOTO.1976 Sircar.2000 Choong.1998">(Hashimoto and Miura 1976; Sircar and Hufton 2000; Choong and Scott 1998)</span> and appendix <a href="#sec:app:LDFHSDM" data-reference-type="ref" data-reference="sec:app:LDFHSDM">8</a>.</p>
<p>Fig. <a href="#fig:concentration_batch" data-reference-type="ref" data-reference="fig:concentration_batch">[fig:concentration_batch]</a> also shows the amount of adsorbate taken up by the adsorbent. In the case of a batch reactor this loading curve is a mirror of the concentration. The result of the simulation is the loading concentration <span class="math inline"><em>C</em><sub><em>q</em></sub></span> which can be transformed to the loading by dividing through the particle density <span class="math inline"><em>ρ</em><sub><em>B</em></sub></span>. The equilibrium loading <span class="math inline"><em>q</em><sub><em>e</em><em>q</em></sub></span> is the amount of solute adsorbed in the state of equilibrium. For the system depicted above with a linear isotherm, <span class="math inline"><em>C</em><sub><em>e</em><em>q</em></sub></span> was determined through the simulation to be 0.023094688636135 mg/L which corresponds to an equilibrium loading of 1.039260969536022 mg/g.</p>
<p>Experiments with different isotherms are shown in fig. <a href="#fig:concentration_batch_isotherms" data-reference-type="ref" data-reference="fig:concentration_batch_isotherms">[fig:concentration_batch_isotherms]</a>.</p>
<p><span id="fig:concentration_batch_isotherms" label="fig:concentration_batch_isotherms">[fig:concentration_batch_isotherms]</span></p>
<p>With the kinetic (diffusion) parameters being the same, the influence of the equilibrium on the rate of the reaction is clearly visible. The same magnitude for the parameters was used (the units are different) and so the shape of the isotherms themselves and the equilibrium loading vary to a similar degree as the curve shown. Although the equilibrium concentration has not quite been reached yet after 6 seconds, it is higher for the Langmuir isotherm depicted in fig <a href="#fig:concentration_batch_isotherms" data-reference-type="ref" data-reference="fig:concentration_batch_isotherms">[fig:concentration_batch_isotherms]</a>.</p>
<p>The <span class="smallcaps">ldf</span> model was developed for surface diffusion, but film diffusion can be added as a boundary condition for the concentration. In order to test film diffusion on its own, we can use a very small Biot number <span class="math inline"><em>B</em><em>i</em></span> to eliminate the influence of surface diffusion. The results of pure film diffusion with <span class="math inline"><em>B</em><em>i</em></span> of order are shown in fig. <a href="#fig:concentration_batch_film" data-reference-type="ref" data-reference="fig:concentration_batch_film">[fig:concentration_batch_film]</a> together with the previous result as a comparison.</p>
<p><span id="fig:concentration_batch_film" label="fig:concentration_batch_film">[fig:concentration_batch_film]</span></p>
<p>We can again see good agreement with the analytical solution and conclude that the addition of film diffusion was successful. The two mechanisms can of course be easily used in conjunction, just by setting their respective mass transfer coefficients to appropriate values.</p>
<h4 id="convergence">Convergence</h4>
<p>Because an analytical solution is known, we can very easily assess the error of the simulation. The <span class="math inline">ℒ<sub>2</sub></span> error of the simulation as described in eq. <a href="#eq:L2 error" data-reference-type="eqref" data-reference="eq:L2 error">[eq:L2 error]</a> and the analytical solution of <a href="#eq:analytical_batch" data-reference-type="eqref" data-reference="eq:analytical_batch">[eq:analytical_batch]</a> is shown in fig. <a href="#fig:EOC_batch_diff" data-reference-type="ref" data-reference="fig:EOC_batch_diff">[fig:EOC_batch_diff]</a> If we use diffusive scaling, which is the standard approach for LBM, we get an <span class="smallcaps">eoc</span> of 2. The relaxation time <span class="math inline">$\tau_{\textsc{\MakeLowercase{ADE}}}$</span> is .</p>
<figure>
<embed src="figures/batch_EOC_diff.pdf" style="width:70.0%" /><figcaption>L2-error for batch reactor using diffusive scaling with the number of spatial steps on the abscissa. The simulation results for different spatial resolutions are marked with blue dots.</figcaption>
</figure>
<p><span id="fig:EOC_batch_diff" label="fig:EOC_batch_diff">[fig:EOC_batch_diff]</span></p>
<p>In this case the solution only depends on the time and because the concentration is homogenous at all time, diffusion does not play a role. So, additionally the error is plotted over the time step in fig. <a href="#fig:EOC_batch_conv" data-reference-type="ref" data-reference="fig:EOC_batch_conv">[fig:EOC_batch_conv]</a>. Now we only achieve an <span class="smallcaps">eoc</span> of 1. Diffusive scaling means <span class="math inline"><em>Δ</em><em>t</em> ∝ <em>Δ</em><em>x</em><sup>2</sup></span>, so this finding suggests that we only have a convergence order of 1 for the time step. The previous <span class="smallcaps">eoc</span> of 2 was then caused by the quadratic scaling of the time step and the actual convergence is of order one. When using acoustic scaling the <span class="smallcaps">eoc</span> is always 1.</p>
<figure>
<embed src="figures/batch_EOC_conv.pdf" style="width:70.0%" /><figcaption>Error for batch reactor using acoustic scaling with the number of time steps on the abscissa. The simulation results for different time steps are marked with blue dots.</figcaption>
</figure>
<p><span id="fig:EOC_batch_conv" label="fig:EOC_batch_conv">[fig:EOC_batch_conv]</span></p>
<p>Simulations with a prescribed source term as function of time and an analytical solution as it was used by Seta <span class="citation" data-cites="Seta.2013">(Seta 2013)</span> were conducted and show a similar convergence behavior (see appendix <a href="#sec:app:source term" data-reference-type="ref" data-reference="sec:app:source term">9</a>). Since that test doesn’t use the adsorption model at all, this suggests that this convergence behavior is not related to the particular source term proposed in this thesis.</p>
<h2 id="sec:fixed-bed_results">Fixed Bed Reactor</h2>
<p>After having validated the solution to the equations describing mass transfer of adsorption, the next step is to look at a fixed bed reactor with moving solute. The goal here is to validate the combination of the advection diffusion equation with the source term from adsorption.</p>
<p>Once an equilibrium has been reached and the constant pattern behavior is established, the analytical solution found by <span class="citation" data-cites="Glueckauf.1947">(Glueckauf and Coates 1947)</span> for both the Langmuir and Freundlich isotherm applies. Adapted to non-dimensional values <span class="citation" data-cites="Worch.2021">(Worch 2021)</span> we get an implicit equation for the concentration <span class="math inline"><em>X</em></span> with <br /><span class="math display">$$\frac{R}{1-R} \log(X) - \frac{1}{1-R} \log(1-X) = N_{s} (-T + 1) + \delta_I
    \label{eq:analytical_fixed}$$</span><br /> where the dimensionless quantities <span class="math inline"><em>T</em></span>, <span class="math inline"><em>X</em></span> and <span class="math inline"><em>N</em><sub><em>s</em></sub></span> are used, with <br /><span class="math display">$$T = \frac{t}{t_{\mathrm{st}}}, \quad X = \frac{c}{C_0}\quad \mathrm{and} \quad N_s = k_s^* t_{\mathrm{st}}
    \label{eq:dimensionless-fixed_bed}$$</span><br /> and an integration constant <span class="math inline"><em>δ</em><sub><em>I</em></sub></span>. We assume that the residence time <span class="math inline"><em>t</em><sub><em>r</em></sub></span> can be neglected. The separation factor <span class="math inline"><em>R</em></span> for the Langmuir isotherm is <br /><span class="math display">$$R = \frac{1}{1 + b\,C_0}\,.$$</span><br /> This is the solution to a plug-flow model, meaning dispersion (e.g. diffusion) is not accounted for. Our model used for the simulation is a dispersed-flow model because it includes a diffusion term.</p>
<h3 id="method">Method</h3>
<p>Eq. <a href="#eq:analytical_fixed" data-reference-type="eqref" data-reference="eq:analytical_fixed">[eq:analytical_fixed]</a> is implicit, so we need to solve it numerically for use in the error calculations. This was done using <em>scipy’s</em> <em>fsolve</em> function, which uses a modified Powell method. The integration constant <span class="math inline"><em>δ</em><sub><em>I</em></sub></span> can be found using the material balance of a <span class="smallcaps">btc</span>: <br /><span class="math display">$$\int\displaylimits_{T=0}^{T(X=1)} \left(1-X\right)\,dT = 1\,.$$</span><br /> Some exemplary values can be found in <span class="citation" data-cites="Worch.2021">(Worch 2021)</span>.</p>
<p>Once the constant pattern has been reached, the eventual breakthrough curve has already formed inside the column as the concentration front. We can transform the x-axis to convert between the two. Time and length along the column can be converted by mirroring around <span class="math inline"><em>x</em><sub><em>s</em><em>t</em></sub></span> using <span class="math inline"><em>t</em> = 2<em>x</em><sub><em>s</em><em>t</em></sub> − <em>x</em></span> and because we use the dimensionless time <span class="math inline"><em>T</em> = <em>t</em>/<em>t</em><sub><em>s</em><em>t</em></sub></span> with <span class="math inline">$t = \frac{q_{0,eq}\, A\, x}{C_0 \dot{V}}$</span>, all factors cancel each other. In combination and additionally centering around <span class="math inline"><em>T</em> = 1</span> we get <br /><span class="math display">$$T = \frac{t}{t_{\mathrm{st}}} = \frac{2x_{\mathrm{st}} - x}{x_{\mathrm{st}}}\,,$$</span><br /> where <span class="math inline"><em>x</em><sub><em>s</em><em>t</em></sub></span> is the position of the center of mass of the <span class="smallcaps">btc</span>, approximated as the position <span class="math inline"><em>x</em></span> where <span class="math inline"><em>C</em>/<em>C</em><sub>0</sub> = 0.6</span>. This procedure removes any influence of the outlet boundary on the shape of the breakthrough curve because we sample from the center of the column.</p>
<h3 id="simulation-setup-1">Simulation Setup</h3>
<p>The reactor is realized as a three-dimensional cuboid with periodic boundary conditions on all sides except the inlet and outlet. A constant fluid velocity is set for the entire volume. The inlet has a Dirichlet boundary condition with <span class="math inline"><em>C</em><sub>0</sub></span>. The process parameters are listed in table <a href="#tab:parameters-fixed_bed" data-reference-type="ref" data-reference="tab:parameters-fixed_bed">[tab:parameters-fixed_bed]</a>.</p>
<table>
<caption>Process parameters for fixed bed reactor.</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: center;">Value</th>
<th style="text-align: right;">Unit</th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Isotherm parameter 1</td>
<td style="text-align: center;"><span class="math inline"><em>q</em><sub><em>m</em></sub></span></td>
<td style="text-align: right;">20</td>
<td style="text-align: left;"><span class="math inline"><em>m</em><em>g</em>/<em>g</em></span></td>
</tr>
<tr class="even">
<td style="text-align: left;">Isotherm parameter 2</td>
<td style="text-align: center;"><span class="math inline"><em>b</em></span></td>
<td style="text-align: right;">0.8</td>
<td style="text-align: left;"><span class="math inline"><em>m</em><em>g</em>/<em>g</em></span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Inlet concentration</td>
<td style="text-align: center;"><span class="math inline"><em>C</em><sub>0</sub></span></td>
<td style="text-align: right;">1</td>
<td style="text-align: left;"><span class="math inline"><em>m</em><em>g</em>/<em>L</em></span></td>
</tr>
<tr class="even">
<td style="text-align: left;">Adsorbent bulk density</td>
<td style="text-align: center;"><span class="math inline"><em>ρ</em><sub><em>B</em></sub></span></td>
<td style="text-align: right;">1</td>
<td style="text-align: left;"><span class="math inline"><em>k</em><em>g</em>/<em>m</em><sup>3</sup></span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Column length</td>
<td style="text-align: center;"><span class="math inline"><em>L</em></span></td>
<td style="text-align: right;">0.05</td>
<td style="text-align: left;"><span class="math inline"><em>m</em></span></td>
</tr>
<tr class="even">
<td style="text-align: left;">Column width</td>
<td style="text-align: center;"><span class="math inline"><em>a</em></span></td>
<td style="text-align: right;">0.0016</td>
<td style="text-align: left;"><span class="math inline"><em>m</em></span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Particle radius</td>
<td style="text-align: center;"><span class="math inline"><em>r</em><sub><em>p</em></sub></span></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"><span class="math inline"><em>m</em></span></td>
</tr>
<tr class="even">
<td style="text-align: left;">Surface diffusion coefficient</td>
<td style="text-align: center;"><span class="math inline"><em>D</em><sub><em>s</em></sub></span></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"><span class="math inline"><em>m</em><sup>2</sup>/<em>s</em><sup>2</sup></span></td>
</tr>
</tbody>
</table>
<p><span id="tab:parameters-fixed_bed" label="tab:parameters-fixed_bed">[tab:parameters-fixed_bed]</span></p>
<p>While the adsorbent bulk density may be uncharacteristically low for a fixed bed reactor, it is reasonable for a slurry reactor and reduces the simulation time considerably. The reason is twofold: first, the stoichiometric time <span class="math inline"><em>t</em><sub><em>s</em><em>t</em></sub></span> is proportional to the mass of adsorbent, so more adsorbent means later breakthrough, and secondly, the increased mass of adsorbent leads to larger reaction rates, which has implications for stability. To counteract this, the time steps have to be increased, which leads to a longer simulation time.</p>
<h3 id="results-1">Results</h3>
<p>Fig. <a href="#fig:concentration-profile" data-reference-type="ref" data-reference="fig:concentration-profile">[fig:concentration-profile]</a> shows the concentration profile in the column after 3400 seconds. The stoichiometric time <span class="math inline"><em>t</em><sub><em>s</em><em>t</em></sub></span> in this case is about 6800 seconds, which leads to the <span class="smallcaps">mtz</span> being roughly centered and enables a clean plot. The intraparticle mass transfer rate <span class="math inline"><em>N</em><sub><em>s</em></sub> = 28</span> is adjusted to reflect that the breakthrough curve was taken at the midpoint of the column. Had the full length of the column been used, the value would be .</p>
<p>The breakthrough curve that resulted from the transformation previously mentioned is shown in fig <a href="#fig:breakthrough" data-reference-type="ref" data-reference="fig:breakthrough">[fig:breakthrough]</a>. It shows good agreement with the analytical solution. There are no obvious deviations in the shape of the curve. We see the characteristic shape of a breakthrough curve with dominating surface diffusion: the curve is not symmetrical around <span class="math inline"><em>T</em> = 1</span>, instead it is slightly flatter for larger concentrations.</p>
<p>Two ways to align the measured curves and the solution are possible. The first is to calculate the expected position of the center of mass and shift the curve by that value, the second is to try and find the center of mass of the actual measured curve. For symmetrical curves this point is <span class="math inline">0.5 <em>C</em><sub>0</sub></span>. Because in this case surface diffusion dominates, it is actually around <span class="math inline">0.56 <em>C</em><sub>0</sub></span>. In this section all plots are aligned using the second method, so that they all cross exactly at <span class="math inline"><em>T</em> = 1</span>, and we can concentrate on the differences in shape. We will discuss the alignment error separately.</p>
<p>The expected position of the <span class="smallcaps">mtz</span> at any point in time can be calculated by rearranging eq. <a href="#eq:mtz_velocity" data-reference-type="eqref" data-reference="eq:mtz_velocity">[eq:mtz_velocity]</a> to get the column position <span class="math inline"><em>h</em>(<em>t</em>)</span>. For <span class="math inline"><em>t</em></span> we insert the simulation time <span class="math inline"><em>t</em><sub><em>s</em><em>i</em><em>m</em></sub></span>. If we compare the expected position and our approximation from the measured curve we get a relative error of around 2<span>%</span>.</p>
<p>The influence of the kinetics and isotherm on the shape can be seen in fig. <a href="#fig:breakthrough-kinetics" data-reference-type="ref" data-reference="fig:breakthrough-kinetics">[fig:breakthrough-kinetics]</a>. The surface diffusion mass transfer parameter <span class="math inline"><em>k</em><sub><em>s</em></sub><sup>*</sup></span> is proportional to <span class="math inline"><em>D</em><sub><em>s</em></sub></span> and determines the speed of the mass transfer. For larger values, which is shown by the green curve in fig. <a href="#fig:breakthrough-kinetics" data-reference-type="ref" data-reference="fig:breakthrough-kinetics">[fig:breakthrough-kinetics]</a>, the curve comes closer to the ideal breakthrough curve with a vertical concentration front.</p>
<p>All the curves in fig. <a href="#fig:breakthrough-kinetics" data-reference-type="ref" data-reference="fig:breakthrough-kinetics">[fig:breakthrough-kinetics]</a> show a Langmuir isotherm, where a larger parameter <span class="math inline"><em>b</em></span> results in a steeper isotherm. As expected, the orange curve with <span class="math inline"><em>b</em> = 0.5</span> is indeed flatter.</p>
<p>Our implementation allows easy access to the value of the source term at any point in time. This is depicted in fig. <a href="#fig:breakthrough-source" data-reference-type="ref" data-reference="fig:breakthrough-source">[fig:breakthrough-source]</a> for two separation factors <span class="math inline"><em>R</em></span>. A smaller value for <span class="math inline"><em>R</em></span> can be caused by a steeper isotherm or a larger initial concentration.</p>
<p>The source term is shown as a dotted line. It is clearly visible that the peak’s height as well as the shape of the curve are different. For larger <span class="math inline"><em>R</em></span> the curve is more asymmetrical with a steeper rise and a longer tail, which is typical for surface diffusion control. This is also visible in the breakthrough curve.</p>
<p>The solution given in eq. <a href="#eq:analytical_fixed" data-reference-type="eqref" data-reference="eq:analytical_fixed">[eq:analytical_fixed]</a> does not include diffusion. This however is impossible to replicate with the approach used in this thesis, since we solve the advection diffusion equation. The influence of diffusion can be seen in fig. <a href="#fig:breakthrough-diffusion" data-reference-type="ref" data-reference="fig:breakthrough-diffusion">[fig:breakthrough-diffusion]</a>.</p>
<p>For larger values of <span class="math inline"><em>D</em></span> the curve flattens and the breakthrough point appears earlier. We can see that for values of <span class="math inline">$D = \num{5E-11}$</span>, which corresponds to <span class="math inline"><em>S</em><em>c</em> = 1559</span>, we already get very good agreement with the analytical solution. Although in this example the particles are fixed in place, and therefore the advection part of eq. <a href="#eq:adv-diff" data-reference-type="eqref" data-reference="eq:adv-diff">[eq:adv-diff]</a> is irrelevant, diffusion does play a large role. The diffusion coefficient of the particle and loading lattices also have an impact on the result. Since we are investigating the convergence to <span class="math inline"><em>D</em> → 0</span> and not any specific substance, all <span class="smallcaps">ade</span> lattices used the same diffusion coefficient.</p>
<h4 id="convergence-1">Convergence</h4>
<p>A series of simulations with a fixed diffusion coefficient will not converge to the analytic solution, for this reason <span class="math inline"><em>Δ</em><em>x</em></span>, <span class="math inline"><em>Δ</em><em>t</em></span> and <span class="math inline"><em>S</em><em>c</em></span> are scaled together. When scaling in a ratio of 1:1:1, this will keep the relaxation parameter <span class="math inline"><em>τ</em></span> constant, similar to diffusive scaling. In this case <span class="math inline">$\tau_{\textsc{\MakeLowercase{ADV}}} = 0.501$</span>. The resulting errors are shown in fig. <a href="#fig:breakthrough-convergence" data-reference-type="ref" data-reference="fig:breakthrough-convergence">[fig:breakthrough-convergence]</a>.</p>
<p>It shows both the error caused by differing shapes and the difference in the position of the center of mass of the curve, called alignment error. Surprisingly they both have very similar values as well as convergence behavior. The order of convergence is around . This means that we get convergence towards a non-dispersive solution even when using a dispersed-flow model.</p>
<p>Just looking at the fluid diffusion, it contributes an error around order . Interestingly the alignment error increases with increasing <span class="math inline"><em>S</em><em>c</em></span>. This can be seen in fig. <a href="#fig:breakthrough-diff-error" data-reference-type="ref" data-reference="fig:breakthrough-diff-error">[fig:breakthrough-diff-error]</a>, which shows the convergence purely based on diffusion with no changes in <span class="math inline"><em>Δ</em><em>x</em></span> or <span class="math inline"><em>Δ</em><em>t</em></span>, instead with changing relaxation parameters <span class="math inline">$\tau_{\textsc{\MakeLowercase{ADV}}}$</span> ranging from to .</p>
<p>Fixed bed reactors can be modelled very well by the linear driving force model <span class="citation" data-cites="Sircar.2000">(Sircar and Hufton 2000)</span> and we have now demonstrated that our model does so as well.</p>
<h4 id="volume-averaged-equations">Volume Averaged Equations</h4>
<p>As a step towards its future use the simulations were also performed using the volume averaged Navier Stokes equations. By taking the porosity into account the volume that is available for the fluid decreases and so the flow rate of solute decreases as well. This will lead to longer stoichiometric times. In the adsorption model this is accounted for only in a porosity factor in the source term for the solute concentration. Because we divide by the stoichiometric time <span class="math inline"><em>t</em><sub><em>s</em><em>t</em></sub></span>, a correct implementation of the <span class="smallcaps">vans</span> equations has therefore no effect on the results in the nondimensionalised graph.</p>
<p>Fig. <a href="#fig:breakthrough-VANS" data-reference-type="ref" data-reference="fig:breakthrough-VANS">[fig:breakthrough-VANS]</a> shows the concentration profiles for two simulations, one with the <span class="smallcaps">nse</span> and one with the <span class="smallcaps">vanse</span>. The center of mass of the curves <span class="math inline"><em>x</em><sub><em>c</em></sub></span> is marked with dashed lines. The shape is again caused by the smaller value of the intraparticle mass transfer rate <span class="math inline"><em>N</em><sub><em>s</em></sub></span> used in these simulations and is to be expected. The breakthrough time is proportional to the porosity <span class="math inline"><em>ε</em></span> and the position of the center of mass <span class="math inline"><em>x</em><sub><em>c</em></sub></span> is inversely proportional.</p>
<p>Table <a href="#tab:breakthrough_times" data-reference-type="ref" data-reference="tab:breakthrough_times">[tab:breakthrough_times]</a> shows the breakthrough times and curve positions for two different porosities and their ratios. The numerator and denominator in the ratios for the time and distance are chosen so that in each case they reflect the porosity. Porosity of 1 in this context means that porosity is not taken into account. The two simulations have a ratio of , which matches the porosity with a relative error of or about 0.63<span>%</span>. This was achieved with a resolution of 21 nodes and <span class="math inline">$\tau_{\textsc{\MakeLowercase{ADE}}} = 0.5001$</span>.</p>
<table>
<caption>Breakthrough curve parameters and corresponding ratios</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Quantity</th>
<th style="text-align: right;">NSE</th>
<th style="text-align: right;">VANS</th>
<th style="text-align: right;">Ratio</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span class="math inline"><em>ε</em></span></td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.941</td>
<td style="text-align: right;">0.941</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline"><em>t</em><sub><em>s</em><em>t</em></sub></span> (s)</td>
<td style="text-align: right;">6410</td>
<td style="text-align: right;">6810</td>
<td style="text-align: right;">0.941</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline"><em>x</em><sub><em>s</em><em>t</em></sub></span> (m)</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;">0.941</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline"><em>x</em><sub><em>c</em></sub></span> (m)</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
<p><span id="tab:breakthrough_times" label="tab:breakthrough_times">[tab:breakthrough_times]</span></p>
<table>
<caption>Process parameters for porosity investigations in a fixed bed reactor</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: center;">Value</th>
<th style="text-align: right;">Unit</th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Isotherm parameter 1</td>
<td style="text-align: center;"><span class="math inline"><em>q</em><sub><em>m</em></sub></span></td>
<td style="text-align: right;">1</td>
<td style="text-align: left;"><span class="math inline"><em>m</em><em>g</em>/<em>g</em></span></td>
</tr>
<tr class="even">
<td style="text-align: left;">Isotherm parameter 2</td>
<td style="text-align: center;"><span class="math inline"><em>b</em></span></td>
<td style="text-align: right;">0.5</td>
<td style="text-align: left;"><span class="math inline"><em>m</em><em>g</em>/<em>L</em></span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Inlet concentration</td>
<td style="text-align: center;"><span class="math inline"><em>C</em><sub>0</sub></span></td>
<td style="text-align: right;">10</td>
<td style="text-align: left;"><span class="math inline"><em>m</em><em>g</em>/<em>L</em></span></td>
</tr>
<tr class="even">
<td style="text-align: left;">Adsorbent bulk density</td>
<td style="text-align: center;"><span class="math inline"><em>ρ</em><sub><em>B</em></sub></span></td>
<td style="text-align: right;">100</td>
<td style="text-align: left;"><span class="math inline"><em>k</em><em>g</em>/<em>m</em><sup>3</sup></span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Particle radius</td>
<td style="text-align: center;"><span class="math inline"><em>r</em><sub><em>p</em></sub></span></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"><span class="math inline"><em>m</em></span></td>
</tr>
</tbody>
</table>
<p><span id="tab:parameters_fixed_bed-VANS" label="tab:parameters_fixed_bed-VANS">[tab:parameters_fixed_bed-VANS]</span></p>
<p>As the parameters of the two most recent simulations are in some places quite different, the new values are listed in table <a href="#tab:parameters_fixed_bed-VANS" data-reference-type="ref" data-reference="tab:parameters_fixed_bed-VANS">[tab:parameters_fixed_bed-VANS]</a>.</p>
<h2 id="static-mixer">Static Mixer</h2>
<p>As an example for a more industrial application a static mixer was chosen. This showcases all aspects of the model with moving solute and fluid and moving particles, which means a variable particle density. While the linear driving model is especially suitable for a fixed bed reactor, with the modifications proposed in this thesis, it can also be applied to other scenarios like this. For this much more complicated setup there was no solution or experimental results available for comparison, but it can be used as a more illustrative example of the possibilities of the model.</p>
<h3 id="simulation-setup-2">Simulation Setup</h3>
<p>The geometry of the mixer can be seen in fig <a href="#fig:mixer_both" data-reference-type="ref" data-reference="fig:mixer_both">[fig:mixer_both]</a> with the concentration of particles and solute after a steady state has been reached. The two other components, fluid and particle loading, are not visible. The particle loading follows the path of the particles exactly. It is zero at the inlet and only increased through adsorption after contact with the solute. Particles are injected on the left-hand side and the solute on the right side.</p>
<figure>
<img src="figures/mixer_both.png" alt="Static mixer with separate inlets for particles and solute." style="width:50.0%" /><figcaption>Static mixer with separate inlets for particles and solute.</figcaption>
</figure>
<p><span id="fig:mixer_both" label="fig:mixer_both">[fig:mixer_both]</span></p>
<p>At the upper outlet a velocity boundary is set with a velocity so that the fluid flows out at the top. The fluid velocity is one-way coupled with the other lattices, in effect dragging the solute and particles with it.</p>
<table>
<caption>Process and simulation parameters for static mixer.</caption>
<thead>
<tr class="header">
<th style="text-align: center;">Parameter</th>
<th style="text-align: right;">Value</th>
<th style="text-align: left;">Unit</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span class="math inline"><em>q</em><sub><em>m</em></sub></span></td>
<td style="text-align: right;">20</td>
<td style="text-align: left;"><span class="math inline"><em>m</em><em>g</em>/<em>g</em></span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline"><em>b</em></span></td>
<td style="text-align: right;">0.5</td>
<td style="text-align: left;"><span class="math inline"><em>m</em><em>g</em>/<em>L</em></span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline"><em>C</em><sub>0</sub></span></td>
<td style="text-align: right;">1</td>
<td style="text-align: left;"><span class="math inline"><em>m</em><em>g</em>/<em>L</em></span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline"><em>ρ</em><sub><em>B</em></sub></span></td>
<td style="text-align: right;">1</td>
<td style="text-align: left;"><span class="math inline"><em>k</em><em>g</em>/<em>m</em><sup>3</sup></span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline"><em>L</em></span></td>
<td style="text-align: right;">0.0133</td>
<td style="text-align: left;"><span class="math inline"><em>m</em></span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline"><em>r</em><sub><em>p</em></sub></span></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"><span class="math inline"><em>m</em></span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline"><em>D</em><sub><em>s</em></sub></span></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"><span class="math inline"><em>m</em><sup>2</sup>/<em>s</em><sup>2</sup></span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline"><em>k</em><sub><em>f</em></sub></span></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"><span class="math inline"><em>m</em><sup>2</sup>/<em>s</em><sup>2</sup></span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline"><em>τ</em></span></td>
<td style="text-align: right;">0.6125</td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<p>In this setup the choice of simulation parameters is restricted by the coupling demands and stability concerns brought up in sec. <a href="#sec:stability" data-reference-type="ref" data-reference="sec:stability">5.3.4</a>. We need the time step of all lattices to match, which can only be achieved by carefully selecting the relaxation parameters and diffusion coefficients.</p>
<h3 id="results-2">Results</h3>
<p>The resulting particle loading can be seen in fig <a href="#fig:mixer" data-reference-type="ref" data-reference="fig:mixer">6.1</a>.</p>
<figure>
<img src="figures/mixer.png" alt="Loading (green) in a static mixer." id="fig:mixer" style="width:80.0%" /><figcaption>Loading (green) in a static mixer.<span label="fig:mixer"></span></figcaption>
</figure>
<p>It shows a gradual mixing of the two phases and the resulting reaction product. This image shows a steady state, so all particles will experience the loading shown in the image. Because the setup has laminar flow, the mixing is relative low and particles do not experience fast changing conditions.</p>
<p>With a setup like this, the limits of the linear driving force model need to be kept in mind. This was described in section <a href="#sec:cyclical_adsorption" data-reference-type="ref" data-reference="sec:cyclical_adsorption">4.1.3.3</a>. A cyclical absorption and desorption that would occur if particles moved in and out of areas of high solute concentration might not be captured accurately. In this laminar case this inaccuracy should not be very large, because the particles and solute are coupled to the fluid and move the same way.</p>
<p>The advection diffusion lattices can produce negative concentrations at concentration fronts where gradients are large. This applies to both the particle and solute lattice and also occurs when there is no reaction. This can be seen in the detail view of fig. <a href="#fig:particle_window" data-reference-type="ref" data-reference="fig:particle_window">[fig:particle_window]</a>.</p>
<figure>
<img src="figures/particle_window" alt="Particle concentration in mixer showing negative concentration. White represents a concentration of 0." style="width:60.0%" /><figcaption>Particle concentration in mixer showing negative concentration. White represents a concentration of <span class="math inline">0</span>.</figcaption>
</figure>
<p><span id="fig:particle_window" label="fig:particle_window">[fig:particle_window]</span></p>
<p>Additionally, a wave pattern of fluctuating sign in the concentration can be seen, which originates at the concentration front. The solute concentration in fig.<a href="#fig:mixer" data-reference-type="ref" data-reference="fig:mixer">6.1</a> also shows these waves. This behavior was also observed in the fixed bed reactor but to a much smaller extent. It unfortunately also leads to negative loading, as the three lattices are directly coupled.</p>
<p>In conclusion, we can say that the adsorption model can be successfully applied to moving particle systems, but it is affected by stability problems of the advection diffusion solution.</p>
<h1 id="conclusion">Conclusion</h1>
<p>A model for adsorption on moving particles using a linear driving force was developed and incorporated into the advection diffusion reaction equation. The model can be solved using the lattice Boltzmann method with separate lattices for fluid, solute, particles and particle loading. The primary mass transport mechanism describing adsorption is surface diffusion but both external mass transfer in the form of film diffusion and alternative internal transfer mechanisms, namely pore diffusion, can be added as well. Different isotherms are possible as well.</p>
<p>Comparison with an analytic solution for the adsorption kinetics in a batch reactor has shown good accuracy. A convergence study showed an order of convergence of 1 for the time step and an <span class="smallcaps">eoc</span> of 2 for diffusive scaling. This behavior can also be observed for other source terms that only depend on time. The model predicts breakthrough curves in a fixed bed reactor well and convergence towards the exact solution was demonstrated. The influence of different adsorption parameters and dispersion caused by diffusion was explored as well. When reducing the fluid diffusion coefficient together with the discretization steps <span class="math inline"><em>Δ</em><em>x</em></span> and <span class="math inline"><em>Δ</em><em>t</em></span> an experimental order of convergence of around 1.4 towards a no-dispersive solution can be observed.</p>
<p>Additionally, the volume averaged Navier Stokes equations were used to better account for the particle volume. The expected delay of the breakthrough was observed.</p>
<p>The model was then applied to a more complex flow in a static mixer with moving particles to demonstrate its potential for use in investigations of the influence of fluid flow on adsorption performance.</p>
<p>Further work can be done to implement the more accurate <span class="smallcaps">ldf</span> model with variable mass transfer coefficients, if the added accuracy is needed. Desorption as seen in a moving bed reactor for example could be another area of study on the way to a complete model of adsorption processes in complex fluid flows. Difficulties with stability caused by, for example, the coupling of the <span class="smallcaps">ade</span> and <span class="smallcaps">nse</span> lattices and large source terms could be addressed by using alternative approaches like the multiple relaxation time <span class="smallcaps">lbm</span>.</p>
<h1 id="sec:app:LDFHSDM">Comparison of LDF and HSDM models</h1>
<p>The homogeneous surface diffusion model (<span class="smallcaps">hsdm</span>) and the linear driving force model <span class="smallcaps">ldf</span> both make similar assumptions. They both only solve for surface diffusion, but the linear driving force model simplifies the concentration profile inside the particle.</p>
<p>For both models an analytical solution exists when using a linear isotherm. The solution for the <span class="smallcaps">ldf</span> was shown in <a href="#eq:analytical_batch" data-reference-type="eqref" data-reference="eq:analytical_batch">[eq:analytical_batch]</a>, the solution for the <span class="smallcaps">hsdm</span> <span class="citation" data-cites="Crank.1975">(Crank 1975)</span> is <br /><span class="math display">$$X = 1 - \frac{1}{1 + D_B} \left(1-\sum_{n=1}^{\infty} \frac{6 D_B (D_B + 1) \exp(-u_n^2 T_B)}{9 + 9 D_B + u_n^2 D_B^2} \right)\,,$$</span><br /> where <span class="math inline"><em>u</em><sub><em>n</em></sub></span> is the nth root of <br /><span class="math display">$$\tan u_n = \frac{3 u_n}{3 + D_B u_n^2}\,.$$</span><br /></p>
<p>An example solution for both models can be seen in fig. <a href="#fig:LDF-HSDM" data-reference-type="ref" data-reference="fig:LDF-HSDM">[fig:LDF-HSDM]</a>.</p>
<p>While the <span class="smallcaps">ldf</span> clearly differs from the more accurate <span class="smallcaps">hsdm</span> solution, it does capture the shape of the curve reasonably well, while being much easier to solve<span class="citation" data-cites="Worch.2021 Tien.1994">(Worch 2021; Tien 1994)</span>.</p>
<h1 id="sec:app:source term">Source Term Validation</h1>
<p>We want to, first and foremost, determine the temporal convergence of a source term, because the adsorption source term only depends on time. Following the example in Seta <span class="citation" data-cites="Seta.2013">(Seta 2013)</span> a time dependent source term given by a function is imposed. The equation to be solved is <br /><span class="math display">$$\frac{\partial T}{\partial t} +\boldsymbol{u}\cdot T = D \nabla^2 T + Q\,.$$</span><br /> Prescribing the source term to be only a function of time, later called type <em>exp</em>, <br /><span class="math display"><em>Q</em> = <em>α</em>exp (<em>α</em><em>t</em>)</span><br /> results in the solution <br /><span class="math display"><em>T</em>(<em>x</em>, <em>y</em>) = exp (<em>α</em><em>t</em>) .</span><br /> The velocity is zero, so no contribution of the advection term is expected.</p>
<p>The relative <span class="math inline"><em>L</em><sub>2</sub></span> error is shown in fig. <a href="#fig:analytical source" data-reference-type="ref" data-reference="fig:analytical source">[fig:analytical source]</a> marked as blue. It exhibits an order of convergence of 1 for both acoustic and diffusive scaling.</p>
<p>On the other hand, prescribing the source term with a spatial component (type <em>sin</em>) to be <br /><span class="math display"><em>Q</em> = (<em>α</em>+2<em>D</em><em>κ</em><sup>2</sup>)sin (<em>κ</em><em>x</em>)sin (<em>κ</em><em>y</em>)exp (<em>α</em><em>t</em>)</span><br /> results in the solution <br /><span class="math display"><em>T</em>(<em>x</em>, <em>y</em>) = sin (<em>κ</em><em>x</em>)sin (<em>κ</em><em>y</em>)exp (<em>α</em><em>t</em>) .</span><br /> The results, together with the previous, can be seen in fig. <a href="#fig:analytical source" data-reference-type="ref" data-reference="fig:analytical source">[fig:analytical source]</a>.</p>
<p>With these four sets of errors we can try to figure out the different contributions of spatial and temporal scaling. As we saw before, when the source is only a function of time, the convergence with respect to time is one. When the solution contains a space dependent term, there is a difference between the scaling methods. In the spatially varying case acoustic scaling actually produces a better <span class="smallcaps">eoc</span>. This can be explained by the fact that in the first case <a href="#eq:case1" data-reference-type="eqref" data-reference="eq:case1">[eq:case1]</a> the spatial resolution has no effect on the error, whereas in the second case <a href="#eq:case2" data-reference-type="eqref" data-reference="eq:case2">[eq:case2]</a> it does and the spatial convergence is better than the temporal.</p>
<p>If we now plot the error over the spatial grid number <span class="math inline"><em>N</em></span> in fig. <a href="#fig:analytical source_space" data-reference-type="ref" data-reference="fig:analytical source_space">[fig:analytical source_space]</a>, we see again a worse <span class="smallcaps">eoc</span> for acoustic scaling. For diffusive scaling we see a much better <span class="smallcaps">eoc</span> for the exponential function, however we have to keep in mind, that that is more a function of having scaled <span class="math inline"><em>Δ</em><em>t</em> ∼ <em>Δ</em><em>x</em><sup>2</sup></span> than anything else. The actual convergence is close to one, since the reduction in <span class="math inline"><em>Δ</em><em>x</em></span> does not actually decrease the error in this case.</p>
<p>For <a href="#eq:case2" data-reference-type="eqref" data-reference="eq:case2">[eq:case2]</a> we see an <span class="smallcaps">eoc</span> of 2 for diffusive scaling, which is the optimal outcome and can be explained by the fact that in this case both the decreasing of <span class="math inline"><em>Δ</em><em>t</em></span> and <span class="math inline"><em>Δ</em><em>x</em></span> contribute to the reduction of the error.</p>
<p><span> =1em </span></p>
<p><img src="figures/logo_round copy.png" alt="image" height="45" /></p>
<div id="refs" class="references">
<div id="ref-Agarwal.2005">
<p>Agarwal, Saurabh, Nishith Verma, and Dieter Mewes. 2005. “A Lattice Boltzmann Model for Adsorption Breakthrough.” <em>Heat and Mass Transfer 2005 41:9</em> 41 (9): 843–54. <a href="https://doi.org/10.1007/S00231-005-0625-X">https://doi.org/10.1007/S00231-005-0625-X</a>.</p>
</div>
<div id="ref-Anderl.2014">
<p>Anderl, Daniela, Martin Bauer, Cornelia Rauh, Ulrich Rüde, and Antonio Delgado. 2014. “Numerical Simulation of Adsorption and Bubble Interaction in Protein Foams Using a Lattice Boltzmann Method.” <em>Food &amp; Function</em> 5 (4): 755–63. <a href="https://doi.org/10.1039/C3FO60374A">https://doi.org/10.1039/C3FO60374A</a>.</p>
</div>
<div id="ref-Azevedo.2001">
<p>Azevedo, Diana Cristina Silva de. 2001. “Separation/Reaction in Simulated Moving Bed Application to the Production of Industrial Sugars.” Ph.D. dissertation, Porto: University of Porto; School of Engineering.</p>
</div>
<div id="ref-Berg.2005">
<p>Berg, U., G. Knoll, E. Kaschka, V. Kreutzer, D. Donnert, P. G. Weidler, and R. Nüesch. 2005. “P-Roc-Phosphorus Recovery from Wastewater by Crystallisation of Calcium Phosphate Compounds.” <em>Journal of Residuals Science and Technology</em> 4 (3). <a href="https://pap.co.at/fileadmin/user_upload/publications/2005_Phosphorus_Recovery_Johannesburg.pdf">https://pap.co.at/fileadmin/user_upload/publications/2005_Phosphorus_Recovery_Johannesburg.pdf</a>.</p>
</div>
<div id="ref-Choong.1998">
<p>Choong, T.S.Y., and D. M. Scott. 1998. “The Linear Driving Force Model for Cyclic Adsorption and Desorption: The Effect of External Fluid-Film Mass Transfer.” <em>Chemical Engineering Science</em> 53 (4): 847–51. <a href="https://doi.org/10.1016/S0009-2509(97)00345-X">https://doi.org/10.1016/S0009-2509(97)00345-X</a>.</p>
</div>
<div id="ref-Cowell.1984">
<p>Cowell, Wayne R. 1984. <em>Sources and Development of Mathematical Software</em>. Prentice-Hall Series in Computational Mathematics. Englewood Cliffs; London: Prentice-Hall.</p>
</div>
<div id="ref-Crank.1975">
<p>Crank, John. 1975. <em>The Mathematics of Diffusion</em>. 2nd ed. Oxford Science Publications. Oxford: Clarendon Press. <a href="http://www-eng.lbl.gov/~shuman/NEXT/MATERIALS&amp;COMPONENTS/Xe_damage/Crank-The-Mathematics-of-Diffusion.pdf">http://www-eng.lbl.gov/~shuman/NEXT/MATERIALS&amp;COMPONENTS/Xe_damage/Crank-The-Mathematics-of-Diffusion.pdf</a>.</p>
</div>
<div id="ref-Dabrowski.2001">
<p>Dąbrowski, A. 2001. “Adsorption — from Theory to Practice.” <em>Advances in Colloid and Interface Science</em> 93 (1-3): 135–224. <a href="https://doi.org/10.1016/S0001-8686(00)00082-8">https://doi.org/10.1016/S0001-8686(00)00082-8</a>.</p>
</div>
<div id="ref-Dotto.2017">
<p>Dotto, Guilherme Luiz, Nina Paula Gonçalves Salau, Jeferson Steffanello Piccin, Tito Roberto Sant’Anna Cadaval, and Luiz Antonio Almeida de Pinto. 2017. “Adsorption Kinetics in Liquid Phase: Modeling for Discontinuous and Continuous Systems.” In <em>Adsorption Processes for Water Treatment and Purification</em>, edited by Adrian Bonilla-Petriciolet, Didilia Ileana Mendoza Castillo, and Hilda Elizabeth Reynel-Ávila, 53–76. Cham: Springer. <a href="https://doi.org/10.1007/978-3-319-58136-1_3">https://doi.org/10.1007/978-3-319-58136-1_3</a>.</p>
</div>
<div id="ref-Enwald.1996">
<p>Enwald, H., E. Peirano, and A.-E Almstedt. 1996. “Eulerian Two-Phase Flow Theory Applied to Fluidization.” <em>International Journal of Multiphase Flow</em> 22: 21–66. <a href="https://doi.org/10.1016/S0301-9322(96)90004-X">https://doi.org/10.1016/S0301-9322(96)90004-X</a>.</p>
</div>
<div id="ref-Ferziger.2002">
<p>Ferziger, Joel Henry, and Milovan Perić. 2002. <em>Computational Methods for Fluid Dynamics</em>. Third, rev. edition. Springer eBook Collection. Heidelberg: Springer. <a href="https://doi.org/10.1007/978-3-642-56026-2">https://doi.org/10.1007/978-3-642-56026-2</a>.</p>
</div>
<div id="ref-Foo.2010">
<p>Foo, K. Y., and B. H. Hameed. 2010. “Insights into the Modeling of Adsorption Isotherm Systems.” <em>Chemical Engineering Journal</em> 156 (1): 2–10. <a href="https://doi.org/10.1016/j.cej.2009.09.013">https://doi.org/10.1016/j.cej.2009.09.013</a>.</p>
</div>
<div id="ref-Glueckauf.1947">
<p>Glueckauf, E., and J. I. Coates. 1947. “Theory of Chromatography; the Influence of Incomplete Equilibrium on the Front Boundary of Chromatograms and on the Effectiveness of Separation.” <em>Journal of the Chemical Society (Resumed)</em>, no. 0: 1315–21. <a href="https://doi.org/10.1039/JR9470001315">https://doi.org/10.1039/JR9470001315</a>.</p>
</div>
<div id="ref-Gruszczynski.2021">
<p>Gruszczyński, Grzegorz, Michał Dzikowski, and Łukasz Łaniewski-Wołłk. 2021. “On Recovering the Second-Order Convergence of the Lattice Boltzmann Method with Reaction-Type Source Terms.” <a href="https://arxiv.org/pdf/2107.03962.pdf">https://arxiv.org/pdf/2107.03962.pdf</a>.</p>
</div>
<div id="ref-Guo.2002">
<p>Guo, Zhaoli, and T. S. Zhao. 2002. “Lattice Boltzmann Model for Incompressible Flows Through Porous Media.” <em>Physical Review. E, Statistical, Nonlinear, and Soft Matter Physics</em> 66 (3 Pt 2B): 036304. <a href="https://doi.org/10.1103/PhysRevE.66.036304">https://doi.org/10.1103/PhysRevE.66.036304</a>.</p>
</div>
<div id="ref-HASHIMOTO.1976">
<p>Hashimoto, Kenji, and Kouichi Miura. 1976. “A Simplified Method to Design Fixed-Bed Adsorbers for the Freundlich Isotherm.” <em>JOURNAL OF CHEMICAL ENGINEERING OF JAPAN</em> 9 (5): 388–92. <a href="https://doi.org/10.1252/jcej.9.388">https://doi.org/10.1252/jcej.9.388</a>.</p>
</div>
<div id="ref-He.2000">
<p>He, Xiaoyi, Ning Li, and Byron Goldstein. 2000. “Lattice Boltzmann Simulation of Diffusion-Convection Systems with Surface Chemical Reaction.” <em>Molecular Simulation</em> 25 (3-4): 145–56. <a href="https://doi.org/10.1080/08927020008044120">https://doi.org/10.1080/08927020008044120</a>.</p>
</div>
<div id="ref-Henn.2016">
<p>Henn, Thomas, Gudrun Thäter, Willy Dörfler, Hermann Nirschl, and Mathias J. Krause. 2016. “Parallel Dilute Particulate Flow Simulations in the Human Nasal Cavity.” <em>Computers &amp; Fluids</em> 124: 197–207. <a href="https://doi.org/10.1016/j.compfluid.2015.08.002">https://doi.org/10.1016/j.compfluid.2015.08.002</a>.</p>
</div>
<div id="ref-Ho.1998b">
<p>Ho, Y. S., and G. McKay. 1998a. “A Comparison of Chemisorption Kinetic Models Applied to Pollutant Removal on Various Sorbents.” <em>Process Safety and Environmental Protection</em> 76 (4): 332–40. <a href="https://doi.org/10.1205/095758298529696">https://doi.org/10.1205/095758298529696</a>.</p>
</div>
<div id="ref-Ho.1998">
<p>———. 1998b. “Sorption of Dye from Aqueous Solution by Peat.” <em>Chemical Engineering Journal</em> 70 (2): 115–24. <a href="https://doi.org/10.1016/S0923-0467(98)00076-1">https://doi.org/10.1016/S0923-0467(98)00076-1</a>.</p>
</div>
<div id="ref-Hocker.2018">
<p>Höcker, Stephan B., Robin Trunk, Willy Dörfler, and Mathias J. Krause. 2018. “Towards the Simulations of Inertial Dense Particulate Flows with a Volume-Averaged Lattice Boltzmann Method.” <em>Computers &amp; Fluids</em> 166: 152–62. <a href="https://doi.org/10.1016/j.compfluid.2018.02.011">https://doi.org/10.1016/j.compfluid.2018.02.011</a>.</p>
</div>
<div id="ref-Hsuen.2000">
<p>Hsuen, Hsiao-Kuo. 2000. “An Improved Linear Driving Force Approximation for Intraparticle Adsorption.” <em>Chemical Engineering Science</em> 55 (17): 3475–80. <a href="https://doi.org/10.1016/S0009-2509(99)00600-4">https://doi.org/10.1016/S0009-2509(99)00600-4</a>.</p>
</div>
<div id="ref-Islam.2004">
<p>Islam, Md.A., Md.M.R. Khan, and Md.S.I. Mozumder. 2004. “Adsorption Equilibrium and Adsorption Kinetics: A Unified Approach.” <em>Chemical Engineering &amp; Technology</em> 27 (10): 1095–8. <a href="https://doi.org/10.1002/ceat.200402084">https://doi.org/10.1002/ceat.200402084</a>.</p>
</div>
<div id="ref-Junk.2005">
<p>Junk, Michael, Axel Klar, and Li-Shi Luo. 2005. “Asymptotic Analysis of the Lattice Boltzmann Equation.” <em>Journal of Computational Physics</em> 210 (2): 676–704. <a href="https://doi.org/10.1016/j.jcp.2005.05.003">https://doi.org/10.1016/j.jcp.2005.05.003</a>.</p>
</div>
<div id="ref-Krause.2021">
<p>Krause, Mathias J., Adrian Kummerländer, Samuel J. Avis, Halim Kusumaatmaja, Davide Dapelo, Fabian Klemens, Maximilian Gaedtke, et al. 2021. “OpenLB—Open Source Lattice Boltzmann Code.” <em>Computers &amp; Mathematics with Applications</em> 81: 258–88. <a href="https://doi.org/10.1016/J.CAMWA.2020.04.033">https://doi.org/10.1016/J.CAMWA.2020.04.033</a>.</p>
</div>
<div id="ref-Kruger.2017">
<p>Krüger, Timm, Halim Kusumaatmaja, Alexandr Kuzmin, Orest Shardt, Goncalo Silva, and Erlend Magnus Viggen. 2017. <em>The Lattice Boltzmann Method</em>. Cham: Springer International Publishing. <a href="https://doi.org/10.1007/978-3-319-44649-3">https://doi.org/10.1007/978-3-319-44649-3</a>.</p>
</div>
<div id="ref-LeVan.2019">
<p>LeVan, Douglas M., Giorgio Carta, and Krista S. Walton. 2019. “Adsorption and Ion Exchange.” In <em>Perry’s Chemical Engineers’ Handbook</em>, edited by Don W. Green and Marylee Z. Southard, 16–11–16–54. New York: McGraw Hill Education.</p>
</div>
<div id="ref-Liaw.1979">
<p>Liaw, C. H., J. S. P. Wang, R. A. Greenkorn, and K. C. Chao. 1979. “Kinetics of Fixed-Bed Adsorption: A New Solution.” <em>AIChE Journal</em> 25 (2): 376–81. <a href="https://doi.org/10.1002/aic.690250229">https://doi.org/10.1002/aic.690250229</a>.</p>
</div>
<div id="ref-Long.2016">
<p>Long, Guo, Xiao Lizhi, Shan Xiaowen, and Zhang Xiaoling. 2016. “Modeling Adsorption with Lattice Boltzmann Equation.” <em>Scientific Reports 2016 6:1</em> 6 (1): 1–9. <a href="https://doi.org/10.1038/srep27134">https://doi.org/10.1038/srep27134</a>.</p>
</div>
<div id="ref-Lynch.2020">
<p>Lynch, Sabrina R., Nitesh Nama, Zelu Xu, Christopher J. Arthurs, Onkar Sahni, and C. Alberto Figueroa. 2020. “Numerical Considerations for Advection-Diffusion Problems in Cardiovascular Hemodynamics.” <em>International Journal for Numerical Methods in Biomedical Engineering</em> 36 (9): e3378. <a href="https://doi.org/10.1002/cnm.3378">https://doi.org/10.1002/cnm.3378</a>.</p>
</div>
<div id="ref-Ma.2017">
<p>Ma, Qiang, Zhenqian Chen, and Hao Liu. 2017. “Multiple-Relaxation-Time Lattice Boltzmann Simulation for Flow, Mass Transfer, and Adsorption in Porous Media.” <em>Physical Review. E</em> 96 (1-1): 013313. <a href="https://doi.org/10.1103/PhysRevE.96.013313">https://doi.org/10.1103/PhysRevE.96.013313</a>.</p>
</div>
<div id="ref-Maier.2021">
<p>Maier, Marie-Luise. 2021. “Coupled Lattice Boltzmann and Discrete Element Method for Reactive Particle Fluid Flows with Applications in Process Engineering.” Ph.D. dissertation, Karlsruhe: Karlsruhe Institut für Technologie.</p>
</div>
<div id="ref-Maier.2018">
<p>Maier, Marie-Luise, Stefanie Milles, Sebastian Schuhmann, Gisela Guthausen, Hermann Nirschl, and Mathias J. Krause. 2018. “Fluid Flow Simulations Verified by Measurements to Investigate Adsorption Processes in a Static Mixer.” <em>Computers &amp; Mathematics with Applications</em> 76 (11-12): 2744–57. <a href="https://doi.org/10.1016/j.camwa.2018.08.066">https://doi.org/10.1016/j.camwa.2018.08.066</a>.</p>
</div>
<div id="ref-Manjhi.2006">
<p>Manjhi, Nilesh, Nishith Verma, Karijm Salem, and Dieter Mewes. 2006. “Lattice Boltzmann Modelling of Unsteady-State 2D Concentration Profiles in Adsorption Bed.” <em>Chemical Engineering Science</em> 61 (8): 2510–21. <a href="https://doi.org/10.1016/j.ces.2005.11.018">https://doi.org/10.1016/j.ces.2005.11.018</a>.</p>
</div>
<div id="ref-Micale.2021">
<p>Micale, Daniele, Riccardo Uglietti, Mauro Bracconi, and Matteo Maestri. 2021. “Coupling Euler-Euler and Microkinetic Modeling for the Simulation of Fluidized Bed Reactors: An Application to the Oxidative Coupling of Methane.” <em>Industrial &amp; Engineering Chemistry Research</em> 60 (18): 6687–97. <a href="https://doi.org/10.1021/acs.iecr.0c05845">https://doi.org/10.1021/acs.iecr.0c05845</a>.</p>
</div>
<div id="ref-Nakao.1983">
<p>Nakao, Shin-Ichi, and Motoyuki Suzuki. 1983. “Mass Transfer Coefficient in Cyclic Adsorption and Desorption.” <em>JOURNAL OF CHEMICAL ENGINEERING OF JAPAN</em> 16 (2): 114–19. <a href="https://doi.org/10.1252/jcej.16.114">https://doi.org/10.1252/jcej.16.114</a>.</p>
</div>
<div id="ref-Neretnieks.1976">
<p>Neretnieks, Ivars. 1976. “Analysis of Some Adsorption Experiments with Activated Carbon.” <em>Chemical Engineering Science</em> 31 (11): 1029–35. <a href="https://doi.org/10.1016/0009-2509(76)87023-6">https://doi.org/10.1016/0009-2509(76)87023-6</a>.</p>
</div>
<div id="ref-Peng.2021">
<p>Peng, Zhigao, Zongwei Deng, Haoxiong Feng, Shenggui Liu, and Yingjun Li. 2021. “Multiscale Lattice Boltzmann Simulation of the Kinetics Process of Methane Desorption-Diffusion in Coal.” <em>ACS Omega</em> 6 (30): 19789–98. <a href="https://doi.org/10.1021/acsomega.1c02499">https://doi.org/10.1021/acsomega.1c02499</a>.</p>
</div>
<div id="ref-Peng.2020">
<p>Peng, Zhigao, Shenggui Liu, Yingjun Li, Zongwei Deng, and Haoxiong Feng. 2020. “Pore-Scale Lattice Boltzmann Simulation of Gas Diffusion–Adsorption Kinetics Considering Adsorption-Induced Diffusivity Change.” <em>Energies</em> 13 (18): 4927. <a href="https://doi.org/10.3390/en13184927">https://doi.org/10.3390/en13184927</a>.</p>
</div>
<div id="ref-Qiu.2009">
<p>Qiu, Hui, Lu Lv, Bing-cai Pan, Qing-jian Zhang, Wei-ming Zhang, and Quan-xing Zhang. 2009. “Critical Review in Adsorption Kinetic Models.” <em>Journal of Zhejiang University-SCIENCE A</em> 10 (5): 716–24. <a href="https://doi.org/10.1631/jzus.A0820524">https://doi.org/10.1631/jzus.A0820524</a>.</p>
</div>
<div id="ref-Raghavan.1983">
<p>Raghavan, N. S., and D. M. Ruthven. 1983. “Numerical Simulation of a Fixed-Bed Adsorption Column by the Method of Orthogonal Collocation.” <em>AIChE Journal</em> 29 (6): 922–25. <a href="https://doi.org/10.1002/aic.690290608">https://doi.org/10.1002/aic.690290608</a>.</p>
</div>
<div id="ref-Ruthven.1984">
<p>Ruthven, Douglas M. 1984. <em>Principles of Adsorption and Adsorption Processes</em>. New York; Chichester: Wiley.</p>
</div>
<div id="ref-Seta.2013">
<p>Seta, Takeshi. 2013. “Implicit Temperature-Correction-Based Immersed-Boundary Thermal Lattice Boltzmann Method for the Simulation of Natural Convection.” <em>Physical Review. E, Statistical, Nonlinear, and Soft Matter Physics</em> 87 (6): 063304. <a href="https://doi.org/10.1103/PhysRevE.87.063304">https://doi.org/10.1103/PhysRevE.87.063304</a>.</p>
</div>
<div id="ref-Sircar.2000">
<p>Sircar, S., and J. R. Hufton. 2000. “Why Does the Linear Driving Force Model for Adsorption Kinetics Work?” <em>Adsorption</em> 6 (2): 137–47. <a href="https://doi.org/10.1023/A:1008965317983">https://doi.org/10.1023/A:1008965317983</a>.</p>
</div>
<div id="ref-Souza.2017">
<p>Souza, P. R., G. L. Dotto, and N.P.G. Salau. 2017. “Detailed Numerical Solution of Pore Volume and Surface Diffusion Model in Adsorption Systems.” <em>Chemical Engineering Research and Design</em> 122: 298–307. <a href="https://doi.org/10.1016/j.cherd.2017.04.021">https://doi.org/10.1016/j.cherd.2017.04.021</a>.</p>
</div>
<div id="ref-Tien.1994">
<p>Tien, Chi. 1994. <em>Adsorption Calculations and Modeling</em>. Butterworth-Heinemann Series in Chemical Engineering. Boston; London: Butterworth-Heinemann.</p>
</div>
<div id="ref-Trunk.2016">
<p>Trunk, Robin, Thomas Henn, Willy Dörfler, Hermann Nirschl, and Mathias J. Krause. 2016. “Inertial Dilute Particulate Fluid Flow Simulations with an Euler–Euler Lattice Boltzmann Method.” <em>Journal of Computational Science</em> 17: 438–45. <a href="https://doi.org/10.1016/j.jocs.2016.03.013">https://doi.org/10.1016/j.jocs.2016.03.013</a>.</p>
</div>
<div id="ref-Vandewalle.2021">
<p>Vandewalle, Laurien A., Guy B. Marin, and Kevin M. van Geem. 2021. “CatchyFOAM: Euler–Euler Cfd Simulations of Fluidized Bed Reactors with Microkinetic Modeling of Gas-Phase and Catalytic Surface Chemistry.” <em>Energy &amp; Fuels</em> 35 (3): 2545–61. <a href="https://doi.org/10.1021/acs.energyfuels.0c02824">https://doi.org/10.1021/acs.energyfuels.0c02824</a>.</p>
</div>
<div id="ref-Wang.2020">
<p>Wang, Jianlong, and Xuan Guo. 2020. “Adsorption Kinetic Models: Physical Meanings, Applications, and Solving Methods.” <em>Journal of Hazardous Materials</em> 390: 122156. <a href="https://doi.org/10.1016/j.jhazmat.2020.122156">https://doi.org/10.1016/j.jhazmat.2020.122156</a>.</p>
</div>
<div id="ref-Whitaker.2013">
<p>Whitaker, S. 2013. <em>The Method of Volume Averaging</em>. Theory and Applications of Transport in Porous Media. Springer Netherlands.</p>
</div>
<div id="ref-Whitaker.1997">
<p>Whitaker, Stephen. 1997. “Volume Averaging of Transport Equations.” In <em>Fluid Transport in Porous Media</em>, edited by J. Prieur Du Plessis, 13:1–60. Advances in Fluid Mechanics, 1353-808X. Southampton: Computational Mechanics.</p>
</div>
<div id="ref-Wood.2003">
<p>Wood, Brian D., Fabien Cherblanc, Michel Quintard, and Stephen Whitaker. 2003. “Volume Averaging for Determining the Effective Dispersion Tensor: Closure Using Periodic Unit Cells and Comparison with Ensemble Averaging.” <em>Water Resources Research</em> 39 (8). <a href="https://doi.org/10.1029/2002WR001723">https://doi.org/10.1029/2002WR001723</a>.</p>
</div>
<div id="ref-Worch.2008">
<p>Worch, Eckhard. 2008. “Fixed-Bed Adsorption in Drinking Water Treatment: A Critical Review on Models and Parameter Estimation.” <em>Journal of Water Supply: Research and Technology-Aqua</em> 57 (3): 171–83. <a href="https://doi.org/10.2166/aqua.2008.100">https://doi.org/10.2166/aqua.2008.100</a>.</p>
</div>
<div id="ref-Worch.2021">
<p>———. 2021. <em>Adsorption Technology in Water Treatment: Fundamentals, Processes, and Modeling</em>. 2nd, revised edition. Berlin Germany; Boston: De Gruyter.</p>
</div>
</div>
</body>
</html>
